!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).NestDB=e()}}(function(){return function o(a,u,s){function c(t,e){if(!u[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(f)return f(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=u[t]={exports:{}};a[t][0].call(i.exports,function(e){return c(a[t][1][e]||e)},i,i.exports,o,a,u,s)}return u[t].exports}for(var f="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,n){var u=e("underscore"),d=e("./model");function r(e,t,n){this.db=e,this.query=t||{},n&&(this.execFn=n)}r.prototype.limit=function(e){return this._limit=e,this},r.prototype.skip=function(e){return this._skip=e,this},r.prototype.sort=function(e){return this._sort=e,this},r.prototype.projection=function(e){return this._projection=e,this},r.prototype.project=function(e){var r,i,o,a=[],t=this;return void 0===this._projection||0===Object.keys(this._projection).length?e:(r=0!==this._projection._id,this._projection=u.omit(this._projection,"_id"),(o=Object.keys(this._projection)).forEach(function(e){if(void 0!==i&&t._projection[e]!==i)throw new Error("Can't both keep and omit fields except for _id");i=t._projection[e]}),e.forEach(function(t){var n;n=1===i?(n={$set:{}},o.forEach(function(e){n.$set[e]=d.getDotValue(t,e),void 0===n.$set[e]&&delete n.$set[e]}),d.modify({},n)):(n={$unset:{}},o.forEach(function(e){n.$unset[e]=!0}),d.modify(t,n)),r?n._id=t._id:delete n._id,a.push(n)}),a)},r.prototype._exec=function(n){var i,a,u,s=[],c=0,f=0,l=this,h=null;function p(e,t){return l.execFn?l.execFn(e,t,n):n(e,t)}this.db.getCandidates(this.query,function(e,t){if(e)return p(e);try{for(i=0;i<t.length;i+=1)if(d.match(t[i],l.query))if(l._sort)s.push(t[i]);else if(l._skip&&l._skip>f)f+=1;else if(s.push(t[i]),c+=1,l._limit&&l._limit<=c)break}catch(e){return p(e)}if(l._sort){a=Object.keys(l._sort);var o=[];for(i=0;i<a.length;i++)u=a[i],o.push({key:u,direction:l._sort[u]});s.sort(function(e,t){var n,r,i;for(i=0;i<o.length;i++)if(0!==(r=(n=o[i]).direction*d.compareThings(d.getDotValue(e,n.key),d.getDotValue(t,n.key),l.db.compareStrings)))return r;return 0});var n=l._limit||s.length,r=l._skip||0;s=s.slice(r,r+n)}try{s=l.project(s)}catch(e){h=e,s=void 0}return p(h,s)})},r.prototype.exec=function(){this.db.executor.push({this:this,fn:this._exec,arguments:arguments})},t.exports=r},{"./model":6,underscore:15}],2:[function(e,t,n){t.exports.uid=function(e){return function(e){var t,n,r,i,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=e.length%3,u="";for(r=0,n=e.length-a;r<n;r+=3)t=(e[r]<<16)+(e[r+1]<<8)+e[r+2],u+=o[(i=t)>>18&63]+o[i>>12&63]+o[i>>6&63]+o[63&i];switch(a){case 1:t=e[e.length-1],u+=o[t>>2],u+=o[t<<4&63],u+="==";break;case 2:t=(e[e.length-2]<<8)+e[e.length-1],u+=o[t>>10],u+=o[t>>4&63],u+=o[t<<2&63],u+="="}return u}(function(e){for(var t,n=new Array(e),r=0;r<e;r++)0==(3&r)&&(t=4294967296*Math.random()),n[r]=t>>>((3&r)<<3)&255;return n}(Math.ceil(Math.max(8,2*e)))).replace(/[+\/]/g,"").slice(0,e)}},{}],3:[function(e,t,n){var r=e("util"),i=e("events"),y=e("async"),v=e("underscore"),o=e("./customUtils"),g=e("./model"),a=e("./executor"),u=e("./indexes"),s=e("./persistence"),m=e("./cursor");function c(e){if(!(this instanceof c))return new c(e);i.call(this);var t=(e=e||{}).filename;this.inMemoryOnly=e.inMemoryOnly||!1,this.autoload=e.autoload||!1,this.timestampData=e.timestampData||!1,"function"==typeof e.idGenerator&&(this._idGenerator=e.idGenerator),t&&"string"==typeof t&&0!==t.length?this.filename=t:(this.filename=null,this.inMemoryOnly=!0),this.compareStrings=e.compareStrings,this.persistence=new s({db:this,afterSerialization:e.afterSerialization,beforeDeserialization:e.beforeDeserialization,corruptAlertThreshold:e.corruptAlertThreshold,storage:e.storage}),this.executor=new a,this.inMemoryOnly&&(this.executor.ready=!0),this.indexes={},this.indexes._id=new u({fieldName:"_id",unique:!0}),this.ttlIndexes={},this.autoload&&this.load(e.onload)}r.inherits(c,i),i.call(c),Object.keys(i.prototype).forEach(function(e){"function"==typeof i.prototype[e]&&(c[e]=i.prototype[e].bind(c))}),c.prototype.loadDatabase=c.prototype.load=function(e){var t=this,n=e||function(e){if(e)throw e};this.executor.push({this:this.persistence,fn:this.persistence.loadDatabase,arguments:[function(e){y.setImmediate(function(){e||(0<t.constructor.listeners("created").length&&t.constructor.emit("created",t),0<t.listeners("loaded").length&&t.emit("loaded")),n(e)})}]},!0)},c.prototype.getAllData=function(){return this.indexes._id.getAll()},c.prototype.resetIndexes=function(t){var n=this;Object.keys(this.indexes).forEach(function(e){n.indexes[e].reset(t)})},c.prototype.ensureIndex=function(t,e){var n,r=e||function(){};if(!(t=t||{}).fieldName)return(n=new Error("Cannot create an index without a fieldName")).missingFieldName=!0,r(n);if(this.indexes[t.fieldName])return r(null);this.indexes[t.fieldName]=new u(t),void 0!==t.expireAfterSeconds&&(this.ttlIndexes[t.fieldName]=t.expireAfterSeconds);try{this.indexes[t.fieldName].insert(this.getAllData())}catch(e){return delete this.indexes[t.fieldName],r(e)}this.persistence.persistNewState([{$$indexCreated:t}],function(e){return r(e||null)})},c.prototype.removeIndex=function(e,t){var n=t||function(){};delete this.indexes[e],this.persistence.persistNewState([{$$indexRemoved:e}],function(e){return n(e||null)})},c.prototype.addToIndexes=function(e){var t,n,r,i=Object.keys(this.indexes);for(t=0;t<i.length;t+=1)try{this.indexes[i[t]].insert(e)}catch(e){n=t,r=e;break}if(r){for(t=0;t<n;t+=1)this.indexes[i[t]].remove(e);throw r}},c.prototype.removeFromIndexes=function(t){var n=this;Object.keys(this.indexes).forEach(function(e){n.indexes[e].remove(t)})},c.prototype.updateIndexes=function(e,t){var n,r,i,o=Object.keys(this.indexes);for(n=0;n<o.length;n+=1)try{this.indexes[o[n]].update(e,t)}catch(e){r=n,i=e;break}if(i){for(n=0;n<r;n+=1)this.indexes[o[n]].revertUpdate(e,t);throw i}},c.prototype.getCandidates=function(t,n,a){var r,i=Object.keys(this.indexes),u=this;"function"==typeof n&&(a=n,n=!1),y.waterfall([function(e){return r=[],Object.keys(t).forEach(function(e){("string"==typeof t[e]||"number"==typeof t[e]||"boolean"==typeof t[e]||v.isDate(t[e])||null===t[e])&&r.push(e)}),0<(r=v.intersection(r,i)).length?e(null,u.indexes[r[0]].getMatching(t[r[0]])):(r=[],Object.keys(t).forEach(function(e){t[e]&&t[e].hasOwnProperty("$in")&&r.push(e)}),0<(r=v.intersection(r,i)).length?e(null,u.indexes[r[0]].getMatching(t[r[0]].$in)):(r=[],Object.keys(t).forEach(function(e){t[e]&&(t[e].hasOwnProperty("$lt")||t[e].hasOwnProperty("$lte")||t[e].hasOwnProperty("$gt")||t[e].hasOwnProperty("$gte"))&&r.push(e)}),0<(r=v.intersection(r,i)).length?e(null,u.indexes[r[0]].getBetweenBounds(t[r[0]])):e(null,u.getAllData())))},function(e){if(n)return a(null,e);var r=[],i=[],o=Object.keys(u.ttlIndexes);e.forEach(function(t){var n=!0;o.forEach(function(e){void 0!==t[e]&&v.isDate(t[e])&&Date.now()>t[e].getTime()+1e3*u.ttlIndexes[e]&&(n=!1)}),n?i.push(t):r.push(t._id)}),y.eachSeries(r,function(e,t){u._remove({_id:e},{},function(e){return e?a(e):t()})},function(e){return a(null,i)})}])},c.prototype._insert=function(e,t){var n,o=this,a=t||function(){},r=function(t,n){var r=this,i=arguments;y.setImmediate(function(){if(!t){var e=Array.isArray(n)?n:[n];0<o.listeners("inserted").length&&e.forEach(function(e){o.emit("inserted",e)})}a.apply(r,i)})};try{n=this.prepareDocumentForInsertion(e),this._insertInCache(n)}catch(e){return r(e)}this.persistence.persistNewState(Array.isArray(n)?n:[n],function(e){return e?r(e):r(null,g.deepCopy(n))})},c.prototype._idGenerator=function(){return o.uid(16)},c.prototype.createNewId=function(){for(var e;e=this._idGenerator(),0<this.indexes._id.getMatching(e).length;);return e},c.prototype.prepareDocumentForInsertion=function(e){var t,n=this;if(Array.isArray(e))t=[],e.forEach(function(e){t.push(n.prepareDocumentForInsertion(e))});else{void 0===(t=g.deepCopy(e))._id&&(t._id=this.createNewId());var r=new Date;this.timestampData&&void 0===t.createdAt&&(t.createdAt=r),this.timestampData&&void 0===t.updatedAt&&(t.updatedAt=r),g.checkObject(t)}return t},c.prototype._insertInCache=function(e){Array.isArray(e)?this._insertMultipleDocsInCache(e):this.addToIndexes(e)},c.prototype._insertMultipleDocsInCache=function(e){var t,n,r;for(t=0;t<e.length;t+=1)try{this.addToIndexes(e[t])}catch(e){r=e,n=t;break}if(r){for(t=0;t<n;t+=1)this.removeFromIndexes(e[t]);throw r}},c.prototype.insert=function(){this.executor.push({this:this,fn:this._insert,arguments:arguments})},c.prototype.count=function(e,t){var n=new m(this,e,function(e,t,n){return e?n(e):n(null,t.length)});if("function"!=typeof t)return n;n.exec(t)},c.prototype.find=function(e,t,n){switch(arguments.length){case 1:t={};break;case 2:"function"==typeof t&&(n=t,t={})}var r=new m(this,e,function(e,t,n){var r,i=[];if(e)return n(e);for(r=0;r<t.length;r+=1)i.push(g.deepCopy(t[r]));return n(null,i)});if(r.projection(t),"function"!=typeof n)return r;r.exec(n)},c.prototype.findOne=function(e,t,n){switch(arguments.length){case 1:t={};break;case 2:"function"==typeof t&&(n=t,t={})}var r=new m(this,e,function(e,t,n){return e?n(e):1===t.length?n(null,g.deepCopy(t[0])):n(null,null)});if(r.projection(t).limit(1),"function"!=typeof n)return r;r.exec(n)},c.prototype._update=function(u,s,c,e){var f,l,t,h,p=this,d=0;"function"==typeof c&&(e=c,c={}),f=e||function(){},l=void 0!==c.multi&&c.multi,t=void 0!==c.upsert&&c.upsert,y.waterfall([function(r){if(!t)return r();new m(p,u).limit(1)._exec(function(t,e){if(t)return f(t);if(1===e.length)return r();var n;try{g.checkObject(s),n=s}catch(e){try{n=g.modify(g.deepCopy(u,!0),s)}catch(t){return f(t)}}return p._insert(n,function(e,t){return e?f(e):f(null,1,t,!0)})})},function(){var r,i,o=[],a=function(e){var t=this,n=arguments;y.setImmediate(function(){e||o&&0<o.length&&0<p.listeners("updated").length&&o.forEach(function(e){p.emit("updated",e.newDoc,e.oldDoc)}),f.apply(t,n)})};p.getCandidates(u,function(e,t){if(e)return a(e);try{for(h=0;h<t.length;h+=1)g.match(t[h],u)&&(l||0===d)&&(d+=1,p.timestampData&&(i=t[h].createdAt),r=g.modify(t[h],s),p.timestampData&&(r.createdAt=i,r.updatedAt=new Date),o.push({oldDoc:t[h],newDoc:r}))}catch(e){return a(e)}try{p.updateIndexes(o)}catch(e){return a(e)}var n=v.pluck(o,"newDoc");p.persistence.persistNewState(n,function(e){if(e)return a(e);if(c.returnUpdatedDocs){var t=[];return n.forEach(function(e){t.push(g.deepCopy(e))}),l||(t=t[0]),a(null,d,t)}return a(null,d)})})}])},c.prototype.update=function(){this.executor.push({this:this,fn:this._update,arguments:arguments})},c.prototype._remove=function(n,e,t){var r,i,o,a=this,u=0,s=[],c=[];"function"==typeof e&&(t=e,e={}),r=t||function(){},o=void 0!==e.multi&&e.multi,i=function(e){var t=this,n=arguments;y.setImmediate(function(){e||c&&0<c.length&&0<a.listeners("removed").length&&c.forEach(function(e){a.emit("removed",e)}),r.apply(t,n)})},this.getCandidates(n,!0,function(e,t){if(e)return i(e);try{t.forEach(function(e){g.match(e,n)&&(o||0===u)&&(u+=1,s.push({$$deleted:!0,_id:e._id}),c.push(e),a.removeFromIndexes(e))})}catch(e){return i(e)}a.persistence.persistNewState(s,function(e){return e?i(e):i(null,u)})})},c.prototype.remove=function(){this.executor.push({this:this,fn:this._remove,arguments:arguments})},c.prototype._destroy=function(e){var t=this,n=e||function(){};t._remove({},{multi:!0},function(e){if(e)return n(e);t.persistence.destroyDatabase(n)})},c.prototype.destroy=function(e){var t=this,n=e||function(){};this.executor.push({this:this,fn:this._destroy,arguments:[function(e){y.setImmediate(function(){e||(0<t.listeners("destroyed").length&&t.emit("destroyed"),0<t.constructor.listeners("destroyed").length&&t.constructor.emit("destroyed",t)),n(e)})}]})},c.plugin=function(t){if("function"==typeof t)t(c);else{if("object"!=typeof t||!t||0===Object.keys(t).length)throw new Error('Invalid plugin: got "'+t+'", expected an object or a function');Object.keys(t).forEach(function(e){c.prototype[e]=t[e]})}return c},t.exports=c},{"./cursor":1,"./customUtils":2,"./executor":4,"./indexes":5,"./model":6,"./persistence":7,async:9,events:16,underscore:15,util:21}],4:[function(e,t,n){var o=e("async");function r(){this.buffer=[],this.ready=!1,this.queue=o.queue(function(e,t){for(var n=[],r=0;r<e.arguments.length;r+=1)n.push(e.arguments[r]);var i=e.arguments[e.arguments.length-1];"function"==typeof i?n[n.length-1]=function(){o.setImmediate(t),i.apply(null,arguments)}:i||0===e.arguments.length?n.push(function(){t()}):n[n.length-1]=function(){t()},e.fn.apply(e.this,n)},1)}r.prototype.push=function(e,t){this.ready||t?this.queue.push(e):this.buffer.push(e)},r.prototype.processBuffer=function(){var e;for(this.ready=!0,e=0;e<this.buffer.length;e+=1)this.queue.push(this.buffer[e]);this.buffer=[]},t.exports=r},{async:9}],5:[function(e,t,n){var a=e("underscore"),r=e("binary-search-tree").AVLTree,u=e("./model");function i(e,t){return e===t}function s(e){return null===e?"$null":"string"==typeof e?"$string"+e:"boolean"==typeof e?"$boolean"+e:"number"==typeof e?"$number"+e:Array.isArray(e)?"$date"+e.getTime():e}function o(e){this.fieldName=e.fieldName,this.unique=e.unique||!1,this.sparse=e.sparse||!1,this.treeOptions={unique:this.unique,compareKeys:u.compareThings,checkValueEquality:i},this.reset()}o.prototype.reset=function(e){this.tree=new r(this.treeOptions),e&&this.insert(e)},o.prototype.insert=function(e){var t,n,r,i,o;if(Array.isArray(e))this.insertMultipleDocs(e);else if(void 0!==(t=u.getDotValue(e,this.fieldName))||!this.sparse)if(Array.isArray(t)){for(n=a.uniq(t,s),r=0;r<n.length;r+=1)try{this.tree.insert(n[r],e)}catch(e){o=e,i=r;break}if(o){for(r=0;r<i;r+=1)this.tree.delete(n[r],e);throw o}}else this.tree.insert(t,e)},o.prototype.insertMultipleDocs=function(e){var t,n,r;for(t=0;t<e.length;t+=1)try{this.insert(e[t])}catch(e){n=e,r=t;break}if(n){for(t=0;t<r;t+=1)this.remove(e[t]);throw n}},o.prototype.remove=function(t){var e,n=this;Array.isArray(t)?t.forEach(function(e){n.remove(e)}):void 0===(e=u.getDotValue(t,this.fieldName))&&this.sparse||(Array.isArray(e)?a.uniq(e,s).forEach(function(e){n.tree.delete(e,t)}):this.tree.delete(e,t))},o.prototype.update=function(t,e){if(Array.isArray(t))this.updateMultipleDocs(t);else{this.remove(t);try{this.insert(e)}catch(e){throw this.insert(t),e}}},o.prototype.updateMultipleDocs=function(e){var t,n,r;for(t=0;t<e.length;t+=1)this.remove(e[t].oldDoc);for(t=0;t<e.length;t+=1)try{this.insert(e[t].newDoc)}catch(e){r=e,n=t;break}if(r){for(t=0;t<n;t+=1)this.remove(e[t].newDoc);for(t=0;t<e.length;t+=1)this.insert(e[t].oldDoc);throw r}},o.prototype.revertUpdate=function(e,t){var n=[];Array.isArray(e)?(e.forEach(function(e){n.push({oldDoc:e.newDoc,newDoc:e.oldDoc})}),this.update(n)):this.update(t,e)},o.prototype.getMatching=function(e){var t=this;if(Array.isArray(e)){var n={},r=[];return e.forEach(function(e){t.getMatching(e).forEach(function(e){n[e._id]=e})}),Object.keys(n).forEach(function(e){r.push(n[e])}),r}return t.tree.search(e)},o.prototype.getBetweenBounds=function(e){return this.tree.betweenBounds(e)},o.prototype.getAll=function(){var n=[];return this.tree.executeOnEveryNode(function(e){var t;for(t=0;t<e.data.length;t+=1)n.push(e.data[t])}),n},t.exports=o},{"./model":6,"binary-search-tree":10,underscore:15}],6:[function(e,t,n){var c=e("underscore"),u={},o={},f={},a={},l={};function r(e,t){if("number"==typeof e&&(e=e.toString()),!("$"!==e[0]||"$$date"===e&&"number"==typeof t||"$$deleted"===e&&!0===t||"$$indexCreated"===e||"$$indexRemoved"===e))throw new Error("Field names cannot begin with the $ character");if(-1!==e.indexOf("."))throw new Error("Field names cannot contain a .")}function s(t){Array.isArray(t)&&t.forEach(function(e){s(e)}),"object"==typeof t&&null!==t&&Object.keys(t).forEach(function(e){r(e,t[e]),s(t[e])})}function h(t,n){var r;return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||c.isDate(t)?t:Array.isArray(t)?(r=[],t.forEach(function(e){r.push(h(e,n))}),r):"object"==typeof t?(r={},Object.keys(t).forEach(function(e){(!n||"$"!==e[0]&&-1===e.indexOf("."))&&(r[e]=h(t[e],n))}),r):void 0}function p(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e||null===e||c.isDate(e)||Array.isArray(e)}function d(e,t){return e<t?-1:t<e?1:0}function y(e,t){var n,r;for(n=0;n<Math.min(e.length,t.length);n+=1)if(0!==(r=v(e[n],t[n])))return r;return d(e.length,t.length)}function v(e,t,n){var r,i,o,a,u=n||d;if(void 0===e)return void 0===t?0:-1;if(void 0===t)return void 0===e?0:1;if(null===e)return null===t?0:-1;if(null===t)return null===e?0:1;if("number"==typeof e)return"number"==typeof t?d(e,t):-1;if("number"==typeof t)return"number"==typeof e?d(e,t):1;if("string"==typeof e)return"string"==typeof t?u(e,t):-1;if("string"==typeof t)return"string"==typeof e?u(e,t):1;if("boolean"==typeof e)return"boolean"==typeof t?d(e,t):-1;if("boolean"==typeof t)return"boolean"==typeof e?d(e,t):1;if(c.isDate(e))return c.isDate(t)?d(e.getTime(),t.getTime()):-1;if(c.isDate(t))return c.isDate(e)?d(e.getTime(),t.getTime()):1;if(Array.isArray(e))return Array.isArray(t)?y(e,t):-1;if(Array.isArray(t))return Array.isArray(e)?y(e,t):1;for(r=Object.keys(e).sort(),i=Object.keys(t).sort(),a=0;a<Math.min(r.length,i.length);a+=1)if(0!==(o=v(e[r[a]],t[i[a]])))return o;return d(r.length,i.length)}function g(e,t){var n,r,i="string"==typeof t?t.split("."):t;if(e){if(0===i.length)return e;if(1===i.length)return e[i[0]];if(Array.isArray(e[i[0]])){if("number"==typeof(n=parseInt(i[1],10))&&!isNaN(n))return g(e[i[0]][n],i.slice(2));for(r=new Array,n=0;n<e[i[0]].length;n+=1)r.push(g(e[i[0]][n],i.slice(1)));return r}return g(e[i[0]],i.slice(1))}}function m(e,t){var n,r,i;if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t)return e===t;if(c.isDate(e)||c.isDate(t))return c.isDate(e)&&c.isDate(t)&&e.getTime()===t.getTime();if((!Array.isArray(e)||!Array.isArray(t))&&(Array.isArray(e)||Array.isArray(t))||void 0===e||void 0===t)return!1;try{n=Object.keys(e),r=Object.keys(t)}catch(e){return!1}if(n.length!==r.length)return!1;for(i=0;i<n.length;i+=1){if(-1===r.indexOf(n[i]))return!1;if(!m(e[n[i]],t[n[i]]))return!1}return!0}function i(e,t){return!("string"!=typeof e&&"number"!=typeof e&&!c.isDate(e)&&"string"!=typeof t&&"number"!=typeof t&&!c.isDate(t))&&typeof e==typeof t}function b(e,t){var n,r,i,o;if(p(e)||p(t))return w({needAKey:e},"needAKey",t);for(n=Object.keys(t),o=0;o<n.length;o+=1)if(i=t[r=n[o]],"$"===r[0]){if(!a[r])throw new Error("Unknown logical operator "+r);if(!a[r](e,i))return!1}else if(!w(e,r,i))return!1;return!0}function w(e,t,n,r){var i,o,a,u,s=g(e,t);if(Array.isArray(s)&&!r){if(Array.isArray(n))return w(e,t,n,!0);if(null!==n&&"object"==typeof n&&!c.isRegExp(n))for(o=Object.keys(n),i=0;i<o.length;i+=1)if(l[o[i]])return w(e,t,n,!0);for(i=0;i<s.length;i+=1)if(w({k:s[i]},"k",n))return!0;return!1}if(null!==n&&"object"==typeof n&&!c.isRegExp(n)&&!Array.isArray(n)){if(o=Object.keys(n),a=c.map(o,function(e){return e[0]}),0!==(u=c.filter(a,function(e){return"$"===e})).length&&u.length!==a.length)throw new Error("You cannot mix operators and normal fields");if(0<u.length){for(i=0;i<o.length;i+=1){if(!f[o[i]])throw new Error("Unknown comparison function "+o[i]);if(!f[o[i]](s,n[o[i]]))return!1}return!0}}return c.isRegExp(n)?f.$regex(s,n):!!m(s,n)}o.$set=function(e,t,n){e[t]=n},o.$unset=function(e,t,n){delete e[t]},o.$push=function(t,n,e){if(t.hasOwnProperty(n)||(t[n]=[]),!Array.isArray(t[n]))throw new Error("Can't $push an element on non-array values");if(null!==e&&"object"==typeof e&&e.$slice&&void 0===e.$each&&(e.$each=[]),null!==e&&"object"==typeof e&&e.$each){if(3<=Object.keys(e).length||2===Object.keys(e).length&&void 0===e.$slice)throw new Error("Can only use $slice in conjunction with $each when $push to array");if(!Array.isArray(e.$each))throw new Error("$each requires an array value");if(e.$each.forEach(function(e){t[n].push(e)}),void 0===e.$slice||"number"!=typeof e.$slice)return;if(0===e.$slice)t[n]=[];else{var r,i,o=t[n].length;e.$slice<0?(r=Math.max(0,o+e.$slice),i=o):0<e.$slice&&(r=0,i=Math.min(o,e.$slice)),t[n]=t[n].slice(r,i)}}else t[n].push(e)},o.$addToSet=function(t,n,r){var i=!0;if(t.hasOwnProperty(n)||(t[n]=[]),!Array.isArray(t[n]))throw new Error("Can't $addToSet an element on non-array values");if(null!==r&&"object"==typeof r&&r.$each){if(1<Object.keys(r).length)throw new Error("Can't use another field in conjunction with $each");if(!Array.isArray(r.$each))throw new Error("$each requires an array value");r.$each.forEach(function(e){o.$addToSet(t,n,e)})}else t[n].forEach(function(e){0===v(e,r)&&(i=!1)}),i&&t[n].push(r)},o.$pop=function(e,t,n){if(!Array.isArray(e[t]))throw new Error("Can't $pop an element from non-array values");if("number"!=typeof n)throw new Error(n+" isn't an integer, can't use it with $pop");0!==n&&(e[t]=0<n?e[t].slice(0,e[t].length-1):e[t].slice(1))},o.$pull=function(e,t,n){var r,i;if(!Array.isArray(e[t]))throw new Error("Can't $pull an element from non-array values");for(i=(r=e[t]).length-1;0<=i;i-=1)b(r[i],n)&&r.splice(i,1)},o.$inc=function(e,t,n){if("number"!=typeof n)throw new Error(n+" must be a number");if("number"!=typeof e[t]){if(c.has(e,t))throw new Error("Don't use the $inc modifier on non-number fields");e[t]=n}else e[t]+=n},o.$max=function(e,t,n){void 0===e[t]?e[t]=n:n>e[t]&&(e[t]=n)},o.$min=function(e,t,n){void 0===e[t]?e[t]=n:n<e[t]&&(e[t]=n)},Object.keys(o).forEach(function(e){var i;u[e]=(i=e,function(e,t,n){var r="string"==typeof t?t.split("."):t;if(1===r.length)o[i](e,t,n);else{if(void 0===e[r[0]]){if("$unset"===i)return;e[r[0]]={}}u[i](e[r[0]],r.slice(1),n)}})}),f.$lt=function(e,t){return i(e,t)&&e<t},f.$lte=function(e,t){return i(e,t)&&e<=t},f.$gt=function(e,t){return i(e,t)&&t<e},f.$gte=function(e,t){return i(e,t)&&t<=e},f.$ne=function(e,t){return void 0===e||!m(e,t)},f.$in=function(e,t){var n;if(!Array.isArray(t))throw new Error("$in operator called with a non-array");for(n=0;n<t.length;n+=1)if(m(e,t[n]))return!0;return!1},f.$nin=function(e,t){if(!Array.isArray(t))throw new Error("$nin operator called with a non-array");return!f.$in(e,t)},f.$regex=function(e,t){if(!c.isRegExp(t))throw new Error("$regex operator called with non regular expression");return"string"==typeof e&&(t.global&&(t.lastIndex=0),t.test(e))},f.$exists=function(e,t){return t=!(!t&&""!==t),void 0===e?!t:t},f.$size=function(e,t){if(!Array.isArray(e))return!1;if(t%1!=0)throw new Error("$size operator called without an integer");return e.length==t},f.$elemMatch=function(e,t){if(!Array.isArray(e))return!1;for(var n=e.length,r=!1;n--;)if(b(e[n],t)){r=!0;break}return r},l.$size=!0,l.$elemMatch=!0,l.$exists=!0,a.$or=function(e,t){var n;if(!Array.isArray(t))throw new Error("$or operator used without an array");for(n=0;n<t.length;n+=1)if(b(e,t[n]))return!0;return!1},a.$and=function(e,t){var n;if(!Array.isArray(t))throw new Error("$and operator used without an array");for(n=0;n<t.length;n+=1)if(!b(e,t[n]))return!1;return!0},a.$not=function(e,t){return!b(e,t)},a.$where=function(e,t){var n;if(!c.isFunction(t))throw new Error("$where operator used without a function");if(n=t.call(e),!c.isBoolean(n))throw new Error("$where function must return boolean");return n},t.exports.serialize=function(e){return JSON.stringify(e,function(e,t){if(r(e,t),void 0!==t)return null===t?null:"function"==typeof this[e].getTime?{$$date:this[e].getTime()}:t})},t.exports.deserialize=function(e){return JSON.parse(e,function(e,t){return"$$date"===e?new Date(t):"string"==typeof t||"number"==typeof t||"boolean"==typeof t||null===t?t:t&&t.$$date?t.$$date:t})},t.exports.deepCopy=h,t.exports.checkObject=s,t.exports.isPrimitiveType=p,t.exports.modify=function(e,n){var r,t,i=Object.keys(n),o=c.map(i,function(e){return e[0]}),a=c.filter(o,function(e){return"$"===e});if(-1!==i.indexOf("_id")&&n._id!==e._id)throw new Error("You cannot change a document's _id");if(0!==a.length&&a.length!==o.length)throw new Error("You cannot mix modifiers and normal fields");if(0===a.length?(r=h(n))._id=e._id:(t=c.uniq(i),r=h(e),t.forEach(function(t){if(!u[t])throw new Error("Unknown modifier "+t);if("object"!=typeof n[t])throw new Error("Modifier "+t+"'s argument must be an object");Object.keys(n[t]).forEach(function(e){u[t](r,e,n[t][e])})})),s(r),e._id!==r._id)throw new Error("You can't change a document's _id");return r},t.exports.getDotValue=g,t.exports.match=b,t.exports.areThingsEqual=m,t.exports.compareThings=v},{underscore:15}],7:[function(e,t,n){var r=e("async"),i=e("./storage"),s=e("./model"),o=e("./customUtils"),a=e("./indexes");function u(e){var t,n,r;if(this.db=e.db,this.inMemoryOnly=this.db.inMemoryOnly,this.filename=this.db.filename,this.corruptAlertThreshold=void 0!==e.corruptAlertThreshold?e.corruptAlertThreshold:.1,this.storage=e.storage||i,!this.inMemoryOnly&&this.filename&&"~"===this.filename.charAt(this.filename.length-1))throw new Error("The datafile name can't end with a ~, which is reserved for crash safe backup files");if(e.afterSerialization&&!e.beforeDeserialization)throw new Error("Serialization hook defined but deserialization hook undefined, cautiously refusing to start NestDB to prevent dataloss");if(!e.afterSerialization&&e.beforeDeserialization)throw new Error("Serialization hook undefined but deserialization hook defined, cautiously refusing to start NestDB to prevent dataloss");for(this.afterSerialization=e.afterSerialization||function(e){return e},this.beforeDeserialization=e.beforeDeserialization||function(e){return e},t=1;t<30;t+=1)for(n=0;n<10;n+=1)if(r=o.uid(t),this.beforeDeserialization(this.afterSerialization(r))!==r)throw new Error("beforeDeserialization is not the reverse of afterSerialization, cautiously refusing to start NestDB to prevent dataloss")}u.prototype.ensureDirectoryExists=function(e,t){throw new Error('Deprecated! Use `require("mkdirp")` instead.')},u.prototype.persistCachedDatabase=function(e){var t=e||function(){},n="",r=this;if(this.inMemoryOnly)return t(null);this.db.getAllData().forEach(function(e){n+=r.afterSerialization(s.serialize(e))+"\n"}),Object.keys(this.db.indexes).forEach(function(e){"_id"!=e&&(n+=r.afterSerialization(s.serialize({$$indexCreated:{fieldName:e,unique:r.db.indexes[e].unique,sparse:r.db.indexes[e].sparse}}))+"\n")}),this.storage.write(this.filename,n,function(e){return e?t(e):(r.db.emit("compacted"),t(null))})},u.prototype.compactDatafile=function(){this.db.executor.push({this:this,fn:this.persistCachedDatabase,arguments:arguments})},u.prototype.setAutocompactionInterval=function(e){var t=this,n=Math.max(e||0,5e3);this.stopAutocompaction(),this.autocompactionIntervalId=setInterval(function(){t.compactDatafile()},n)},u.prototype.stopAutocompaction=function(){this.autocompactionIntervalId&&clearInterval(this.autocompactionIntervalId)},u.prototype.persistNewState=function(e,t){var n=this,r="",i=t||function(){};return n.inMemoryOnly?i(null):(e.forEach(function(e){r+=n.afterSerialization(s.serialize(e))+"\n"}),0===r.length?i(null):void this.storage.append(n.filename,r,function(e){return i(e)}))},u.prototype.treatRawData=function(e){var t,n=e.split("\n"),r={},i=[],o={},a=-1;for(t=0;t<n.length;t+=1){var u;try{(u=s.deserialize(this.beforeDeserialization(n[t])))._id?!0===u.$$deleted?delete r[u._id]:r[u._id]=u:u.$$indexCreated&&null!=u.$$indexCreated.fieldName?o[u.$$indexCreated.fieldName]=u.$$indexCreated:"string"==typeof u.$$indexRemoved&&delete o[u.$$indexRemoved]}catch(e){a+=1}}if(0<n.length&&a/n.length>this.corruptAlertThreshold)throw new Error("More than "+Math.floor(100*this.corruptAlertThreshold)+"% of the data file is corrupt, the wrong beforeDeserialization hook may be used. Cautiously refusing to start NestDB to prevent dataloss");return Object.keys(r).forEach(function(e){i.push(r[e])}),{data:i,indexes:o}},u.prototype.loadDatabase=function(e){var t=e||function(){},i=this;if(i.db.resetIndexes(),i.inMemoryOnly)return t(null);r.waterfall([function(r){i.storage.init(i.filename,function(e){if(e)return r(e);i.storage.read(i.filename,function(e,t){if(e)return r(e);try{var n=i.treatRawData(t)}catch(e){return r(e)}Object.keys(n.indexes).forEach(function(e){i.db.indexes[e]=new a(n.indexes[e])});try{i.db.resetIndexes(n.data)}catch(e){return i.db.resetIndexes(),r(e)}i.db.persistence.persistCachedDatabase(r)})})}],function(e){return e?t(e):(i.db.executor.processBuffer(),t(null))})},u.prototype.destroyDatabase=function(e){var t=e||function(){};if(this.db.resetIndexes(),this.inMemoryOnly)return t(null);this.storage.remove(this.filename,t)},t.exports=u},{"./customUtils":2,"./indexes":5,"./model":6,"./storage":8,async:9}],8:[function(e,t,n){var o=e("localforage"),r={};o.config({name:"NestDB",storeName:"nestdbdata"}),r.write=function(e,t,n){o.setItem(e,t,n)},r.append=function(n,r,i){o.getItem(n,function(e,t){if(e)return i(e);t=t||"",t+=r,o.setItem(n,t,i)})},r.read=function(e,n){o.getItem(e,function(e,t){if(e)return n(e);n(null,t||"")})},r.remove=function(e,t){o.removeItem(e,t)},r.init=function(e,t){return t(null)},t.exports.init=r.init,t.exports.read=r.read,t.exports.write=r.write,t.exports.append=r.append,t.exports.remove=r.remove},{localforage:14}],9:[function(e,P,t){(function(F,B,z){!function(){var e,v={};function g(){}function s(e){return e}function t(e){return!!e}function n(e){return!e}var r="object"==typeof self&&self.self===self&&self||"object"==typeof B&&B.global===B&&B||this;function f(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function m(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}null!=r&&(e=r.async),v.noConflict=function(){return r.async=e,v};var i=Object.prototype.toString,b=Array.isArray||function(e){return"[object Array]"===i.call(e)};function a(e){return b(e)||"number"==typeof e.length&&0<=e.length&&e.length%1==0}function w(e,t){for(var n=-1,r=e.length;++n<r;)t(e[n],n,e)}function c(e,t){for(var n=-1,r=e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function o(e){return c(Array(e),function(e,t){return t})}function _(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var k=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};function l(e){var t,n,r=-1;return a(e)?(t=e.length,function(){return++r<t?r:null}):(n=k(e),t=n.length,function(){return++r<t?n[r]:null})}function x(r,i){return i=null==i?r.length-1:+i,function(){for(var e=Math.max(arguments.length-i,0),t=Array(e),n=0;n<e;n++)t[n]=arguments[n+i];switch(i){case 0:return r.call(this,t);case 1:return r.call(this,arguments[0],t)}}}function u(r){return function(e,t,n){return r(e,n)}}var h="function"==typeof z&&z,p=h?function(e){h(e)}:function(e){setTimeout(e,0)};function d(c){return function(n,r,i){i=m(i||g);var o=l(n=n||[]);if(c<=0)return i(null);var a=!1,u=0,s=!1;!function t(){if(a&&u<=0)return i(null);for(;u<c&&!s;){var e=o();if(null===e)return a=!0,void(u<=0&&i(null));u+=1,r(n[e],e,f(function(e){u-=1,e?(i(e),s=!0):t()}))}}()}}function y(r){return function(e,t,n){return r(v.eachOf,e,t,n)}}function E(i){return function(e,t,n,r){return i(d(t),e,n,r)}}function O(r){return function(e,t,n){return r(v.eachOfSeries,e,t,n)}}function A(e,t,i,n){n=m(n||g);var o=a(t=t||[])?[]:{};e(t,function(e,n,r){i(e,function(e,t){o[n]=t,r(e)})},function(e){n(e,o)})}function I(e,t,i,n){var o=[];e(t,function(t,n,r){i(t,function(e){e&&o.push({index:n,value:t}),r()})},function(){n(c(o.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function j(e,t,n,r){I(e,t,function(e,t){n(e,function(e){t(!e)})},r)}function S(a,u,s){return function(e,t,r,i){function n(){i&&i(s(!1,void 0))}function o(t,e,n){if(!i)return n();r(t,function(e){i&&u(e)&&(i(s(!0,t)),i=r=!1),n()})}3<arguments.length?a(e,t,o,n):(i=r,r=t,a(e,o,n))}}function D(e,t){return t}function $(e,t,n){n=n||g;var i=a(t)?[]:{};e(t,function(e,n,r){e(x(function(e,t){t.length<=1&&(t=t[0]),i[n]=t,r(e)}))},function(e){n(e,i)})}function N(e,t,r,n){var i=[];e(t,function(e,t,n){r(e,function(e,t){i=i.concat(t||[]),n(e)})},function(e){n(e,i)})}function T(r,e,t){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");function n(n,e,r,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(n.started=!0,b(e)||(e=[e]),0===e.length&&n.idle())return v.setImmediate(function(){n.drain()});w(e,function(e){var t={data:e,callback:i||g};r?n.tasks.unshift(t):n.tasks.push(t),n.tasks.length===n.concurrency&&n.saturated()}),v.setImmediate(n.process)}function i(t,n){return function(){o-=1;var r=!1,e=arguments;w(n,function(n){w(a,function(e,t){e!==n||r||(a.splice(t,1),r=!0)}),n.callback.apply(n,e)}),t.tasks.length+o===0&&t.drain(),t.process()}}var o=0,a=[],u={tasks:[],concurrency:e,payload:t,saturated:g,empty:g,drain:g,started:!1,paused:!1,push:function(e,t){n(u,e,!1,t)},kill:function(){u.drain=g,u.tasks=[]},unshift:function(e,t){n(u,e,!0,t)},process:function(){for(;!u.paused&&o<u.concurrency&&u.tasks.length;){var e=u.payload?u.tasks.splice(0,u.payload):u.tasks.splice(0,u.tasks.length),t=c(e,function(e){return e.data});0===u.tasks.length&&u.empty(),o+=1,a.push(e[0]);var n=f(i(u,e));r(t,n)}},length:function(){return u.tasks.length},running:function(){return o},workersList:function(){return a},idle:function(){return u.tasks.length+o===0},pause:function(){u.paused=!0},resume:function(){if(!1!==u.paused){u.paused=!1;for(var e=Math.min(u.concurrency,u.tasks.length),t=1;t<=e;t++)v.setImmediate(u.process)}}};return u}function C(n){return x(function(e,t){e.apply(null,t.concat([x(function(e,t){"object"==typeof console&&(e?console.error&&console.error(e):console[n]&&w(t,function(e){console[n](e)}))})]))})}function M(r){return function(e,t,n){r(o(e),t,n)}}function R(o){return x(function(t,e){var n=x(function(r){var i=this,e=r.pop();return o(t,function(e,t,n){e.apply(i,r.concat([n]))},e)});return e.length?n.apply(this,e):n})}function L(r){return x(function(e){var t=e.pop();e.push(function(){var e=arguments;n?v.setImmediate(function(){t.apply(null,e)}):t.apply(null,e)});var n=!0;r.apply(this,e),n=!1})}"object"==typeof F&&"function"==typeof F.nextTick?v.nextTick=F.nextTick:v.nextTick=p,v.setImmediate=h?p:v.nextTick,v.forEach=v.each=function(e,t,n){return v.eachOf(e,u(t),n)},v.forEachSeries=v.eachSeries=function(e,t,n){return v.eachOfSeries(e,u(t),n)},v.forEachLimit=v.eachLimit=function(e,t,n,r){return d(t)(e,u(n),r)},v.forEachOf=v.eachOf=function(e,t,n){n=m(n||g);for(var r,i=l(e=e||[]),o=0;null!=(r=i());)o+=1,t(e[r],r,f(a));function a(e){o--,e?n(e):null===r&&o<=0&&n(null)}0===o&&n(null)},v.forEachOfSeries=v.eachOfSeries=function(e,r,i){i=m(i||g);var o=l(e=e||[]),a=o();!function t(){var n=!0;if(null===a)return i(null);r(e[a],a,f(function(e){if(e)i(e);else{if(null===(a=o()))return i(null);n?v.setImmediate(t):t()}})),n=!1}()},v.forEachOfLimit=v.eachOfLimit=function(e,t,n,r){d(t)(e,n,r)},v.map=y(A),v.mapSeries=O(A),v.mapLimit=E(A),v.inject=v.foldl=v.reduce=function(e,r,i,t){v.eachOfSeries(e,function(e,t,n){i(r,e,function(e,t){r=t,n(e)})},function(e){t(e,r)})},v.foldr=v.reduceRight=function(e,t,n,r){var i=c(e,s).reverse();v.reduce(i,t,n,r)},v.transform=function(e,r,i,t){3===arguments.length&&(t=i,i=r,r=b(e)?[]:{}),v.eachOf(e,function(e,t,n){i(r,e,t,n)},function(e){t(e,r)})},v.select=v.filter=y(I),v.selectLimit=v.filterLimit=E(I),v.selectSeries=v.filterSeries=O(I),v.reject=y(j),v.rejectLimit=E(j),v.rejectSeries=O(j),v.any=v.some=S(v.eachOf,t,s),v.someLimit=S(v.eachOfLimit,t,s),v.all=v.every=S(v.eachOf,n,n),v.everyLimit=S(v.eachOfLimit,n,n),v.detect=S(v.eachOf,s,D),v.detectSeries=S(v.eachOfSeries,s,D),v.detectLimit=S(v.eachOfLimit,s,D),v.sortBy=function(e,t,n){function r(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:r<n?1:0}v.map(e,function(n,r){t(n,function(e,t){e?r(e):r(null,{value:n,criteria:t})})},function(e,t){if(e)return n(e);n(null,c(t.sort(r),function(e){return e.value}))})},v.auto=function(u,s,c){"function"==typeof s&&(c=s,s=null),c=m(c||g);var e=k(u),t=e.length;if(!t)return c(null);s||(s=t);var f={},l=0,h=!1,p=[];function d(e){p.unshift(e)}function y(){t--,w(p.slice(0),function(e){e()})}d(function(){t||c(null,f)}),w(e,function(o){if(!h){for(var e,n=b(u[o])?u[o]:[u[o]],r=x(function(e,t){if(l--,t.length<=1&&(t=t[0]),e){var n={};i=function(e,t){n[t]=e},w(k(r=f),function(e){i(r[e],e)}),n[o]=t,h=!0,c(e,n)}else f[o]=t,v.setImmediate(y);var r,i}),t=n.slice(0,n.length-1),i=t.length;i--;){if(!(e=u[t[i]]))throw new Error("Has nonexistent dependency in "+t.join(", "));if(b(e)&&0<=_(e,o))throw new Error("Has cyclic dependencies")}a()?(l++,n[n.length-1](r,f)):d(function e(){a()&&(l++,0<=(t=_(p,e))&&p.splice(t,1),n[n.length-1](r,f));var t})}function a(){return l<s&&(r=function(e,t){return e&&f.hasOwnProperty(t)},i=!0,w(t,function(e,t,n){i=r(i,e,t,n)}),i)&&!f.hasOwnProperty(o);var r,i}})},v.retry=function(e,t,n){var o=[],a={times:5,interval:0};var r=arguments.length;if(r<1||3<r)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function i(n,t){function e(e,r){return function(n){e(function(e,t){n(!e||r,{err:e,result:t})},t)}}function r(t){return function(e){setTimeout(function(){e(null)},t)}}for(;a.times;){var i=!(a.times-=1);o.push(e(a.task,i)),!i&&0<a.interval&&o.push(r(a.interval))}v.series(o,function(e,t){t=t[t.length-1],(n||a.callback)(t.err,t.result)})}return r<=2&&"function"==typeof e&&(n=t,t=e),"function"!=typeof e&&function(e,t){if("number"==typeof t)e.times=parseInt(t,10)||5;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||5,e.interval=parseInt(t.interval,10)||0}}(a,e),a.callback=n,a.task=t,a.callback?i():i},v.waterfall=function(e,o){if(o=m(o||g),!b(e)){var t=new Error("First argument to waterfall must be an array of functions");return o(t)}if(!e.length)return o();!function r(i){return x(function(e,t){if(e)o.apply(null,[e].concat(t));else{var n=i.next();n?t.push(r(n)):t.push(o),L(i).apply(null,t)}})}(v.iterator(e))()},v.parallel=function(e,t){$(v.eachOf,e,t)},v.parallelLimit=function(e,t,n){$(d(t),e,n)},v.series=function(e,t){$(v.eachOfSeries,e,t)},v.iterator=function(r){return function e(t){function n(){return r.length&&r[t].apply(null,arguments),n.next()}return n.next=function(){return t<r.length-1?e(t+1):null},n}(0)},v.apply=x(function(t,n){return x(function(e){return t.apply(null,n.concat(e))})}),v.concat=y(N),v.concatSeries=O(N),v.whilst=function(n,r,i){if(i=i||g,n()){var o=x(function(e,t){e?i(e):n.apply(this,t)?r(o):i.apply(null,[null].concat(t))});r(o)}else i(null)},v.doWhilst=function(e,t,n){var r=0;return v.whilst(function(){return++r<=1||t.apply(this,arguments)},e,n)},v.until=function(e,t,n){return v.whilst(function(){return!e.apply(this,arguments)},t,n)},v.doUntil=function(e,t,n){return v.doWhilst(e,function(){return!t.apply(this,arguments)},n)},v.during=function(n,r,i){i=i||g;var o=x(function(e,t){e?i(e):(t.push(a),n.apply(this,t))}),a=function(e,t){e?i(e):t?r(o):i(null)};n(a)},v.doDuring=function(e,t,n){var r=0;v.during(function(e){r++<1?e(null,!0):t.apply(this,arguments)},e,n)},v.queue=function(n,e){return T(function(e,t){n(e[0],t)},e,1)},v.priorityQueue=function(e,t){function o(e,t){return e.priority-t.priority}var r=v.queue(e,t);return r.push=function(e,t,n){!function(n,e,r,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(n.started=!0,b(e)||(e=[e]),0===e.length)return v.setImmediate(function(){n.drain()});w(e,function(e){var t={data:e,priority:r,callback:"function"==typeof i?i:g};n.tasks.splice(function(e,t,n){for(var r=-1,i=e.length-1;r<i;){var o=r+(i-r+1>>>1);0<=n(t,e[o])?r=o:i=o-1}return r}(n.tasks,t,o)+1,0,t),n.tasks.length===n.concurrency&&n.saturated(),v.setImmediate(n.process)})}(r,e,t,n)},delete r.unshift,r},v.cargo=function(e,t){return T(e,1,t)},v.log=C("log"),v.dir=C("dir"),v.memoize=function(n,r){var o={},a={},u=Object.prototype.hasOwnProperty;r=r||s;var e=x(function(e){var t=e.pop(),i=r.apply(null,e);u.call(o,i)?v.setImmediate(function(){t.apply(null,o[i])}):u.call(a,i)?a[i].push(t):(a[i]=[t],n.apply(null,e.concat([x(function(e){o[i]=e;var t=a[i];delete a[i];for(var n=0,r=t.length;n<r;n++)t[n].apply(null,e)})])))});return e.memo=o,e.unmemoized=n,e},v.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},v.times=M(v.map),v.timesSeries=M(v.mapSeries),v.timesLimit=function(e,t,n,r){return v.mapLimit(o(e),t,n,r)},v.seq=function(){var t=arguments;return x(function(e){var r=this,n=e[e.length-1];"function"==typeof n?e.pop():n=g,v.reduce(t,e,function(e,t,n){t.apply(r,e.concat([x(function(e,t){n(e,t)})]))},function(e,t){n.apply(r,[e].concat(t))})})},v.compose=function(){return v.seq.apply(null,Array.prototype.reverse.call(arguments))},v.applyEach=R(v.eachOf),v.applyEachSeries=R(v.eachOfSeries),v.forever=function(e,t){var n=f(t||g),r=L(e);!function e(t){if(t)return n(t);r(e)}()},v.ensureAsync=L,v.constant=x(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),v.wrapSync=v.asyncify=function(o){return x(function(e){var t,n,r,i=e.pop();try{t=o.apply(this,e)}catch(e){return i(e)}("function"===(r=typeof(n=t))||"object"===r&&n)&&"function"==typeof t.then?t.then(function(e){i(null,e)}).catch(function(e){i(e.message?e:new Error(e))}):i(null,t)})},"object"==typeof P&&P.exports?P.exports=v:r.async=v}()}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:18,timers:19}],10:[function(e,t,n){t.exports.BinarySearchTree=e("./lib/bst"),t.exports.AVLTree=e("./lib/avltree")},{"./lib/avltree":11,"./lib/bst":12}],11:[function(e,t,n){var r=e("./bst"),i=e("./customUtils"),o=e("util");e("underscore");function a(e){this.tree=new u(e)}function u(e){e=e||{},this.left=null,this.right=null,this.parent=void 0!==e.parent?e.parent:null,e.hasOwnProperty("key")&&(this.key=e.key),this.data=e.hasOwnProperty("value")?[e.value]:[],this.unique=e.unique||!1,this.compareKeys=e.compareKeys||i.defaultCompareKeysFunction,this.checkValueEquality=e.checkValueEquality||i.defaultCheckValueEquality}o.inherits(u,r),(a._AVLTree=u).prototype.checkHeightCorrect=function(){var e,t;if(this.hasOwnProperty("key")){if(this.left&&void 0===this.left.height)throw new Error("Undefined height for node "+this.left.key);if(this.right&&void 0===this.right.height)throw new Error("Undefined height for node "+this.right.key);if(void 0===this.height)throw new Error("Undefined height for node "+this.key);if(e=this.left?this.left.height:0,t=this.right?this.right.height:0,this.height!==1+Math.max(e,t))throw new Error("Height constraint failed for node "+this.key);this.left&&this.left.checkHeightCorrect(),this.right&&this.right.checkHeightCorrect()}},u.prototype.balanceFactor=function(){return(this.left?this.left.height:0)-(this.right?this.right.height:0)},u.prototype.checkBalanceFactors=function(){if(1<Math.abs(this.balanceFactor()))throw new Error("Tree is unbalanced at node "+this.key);this.left&&this.left.checkBalanceFactors(),this.right&&this.right.checkBalanceFactors()},u.prototype.checkIsAVLT=function(){u.super_.prototype.checkIsBST.call(this),this.checkHeightCorrect(),this.checkBalanceFactors()},a.prototype.checkIsAVLT=function(){this.tree.checkIsAVLT()},u.prototype.rightRotation=function(){var e,t,n,r,i=this,o=this.left;return o?(e=o.right,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,(o.right=i).parent=o,(i.left=e)&&(e.parent=i),t=o.left?o.left.height:0,n=e?e.height:0,r=i.right?i.right.height:0,i.height=Math.max(n,r)+1,o.height=Math.max(t,i.height)+1,o):this},u.prototype.leftRotation=function(){var e,t,n,r,i=this,o=this.right;return o?(e=o.left,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,(o.left=i).parent=o,(i.right=e)&&(e.parent=i),t=i.left?i.left.height:0,n=e?e.height:0,r=o.right?o.right.height:0,i.height=Math.max(t,n)+1,o.height=Math.max(r,i.height)+1,o):this},u.prototype.rightTooSmall=function(){return this.balanceFactor()<=1?this:(this.left.balanceFactor()<0&&this.left.leftRotation(),this.rightRotation())},u.prototype.leftTooSmall=function(){return-1<=this.balanceFactor()?this:(0<this.right.balanceFactor()&&this.right.rightRotation(),this.leftRotation())},u.prototype.rebalanceAlongPath=function(e){var t,n,r=this;if(!this.hasOwnProperty("key"))return delete this.height,this;for(n=e.length-1;0<=n;n-=1)e[n].height=1+Math.max(e[n].left?e[n].left.height:0,e[n].right?e[n].right.height:0),1<e[n].balanceFactor()&&(t=e[n].rightTooSmall(),0===n&&(r=t)),e[n].balanceFactor()<-1&&(t=e[n].leftTooSmall(),0===n&&(r=t));return r},u.prototype.insert=function(e,t){var n=[],r=this;if(!this.hasOwnProperty("key"))return this.key=e,this.data.push(t),this.height=1,this;for(;;){if(0===r.compareKeys(r.key,e)){if(r.unique){var i=new Error("Can't insert key "+e+", it violates the unique constraint");throw i.key=e,i.errorType="uniqueViolated",i}return r.data.push(t),this}if(n.push(r),r.compareKeys(e,r.key)<0){if(!r.left){n.push(r.createLeftChild({key:e,value:t}));break}r=r.left}else{if(!r.right){n.push(r.createRightChild({key:e,value:t}));break}r=r.right}}return this.rebalanceAlongPath(n)},a.prototype.insert=function(e,t){var n=this.tree.insert(e,t);n&&(this.tree=n)},u.prototype.delete=function(e,t){var n,r=[],i=this,o=[];if(!this.hasOwnProperty("key"))return this;for(;0!==i.compareKeys(e,i.key);)if(o.push(i),i.compareKeys(e,i.key)<0){if(!i.left)return this;i=i.left}else{if(!i.right)return this;i=i.right}if(1<i.data.length&&void 0!==t)return i.data.forEach(function(e){i.checkValueEquality(e,t)||r.push(e)}),i.data=r,this;if(!i.left&&!i.right)return i===this?(delete i.key,i.data=[],delete i.height,this):(i.parent.left===i?i.parent.left=null:i.parent.right=null,this.rebalanceAlongPath(o));if(!i.left||!i.right)return n=i.left?i.left:i.right,i===this?(n.parent=null,n):(i.parent.left===i?(i.parent.left=n).parent=i.parent:(i.parent.right=n).parent=i.parent,this.rebalanceAlongPath(o));if(o.push(i),!(n=i.left).right)return i.key=n.key,i.data=n.data,i.left=n.left,n.left&&(n.left.parent=i),this.rebalanceAlongPath(o);for(;n.right;)o.push(n),n=n.right;return i.key=n.key,i.data=n.data,n.parent.right=n.left,n.left&&(n.left.parent=n.parent),this.rebalanceAlongPath(o)},a.prototype.delete=function(e,t){var n=this.tree.delete(e,t);n&&(this.tree=n)},["getNumberOfKeys","search","betweenBounds","prettyPrint","executeOnEveryNode"].forEach(function(e){a.prototype[e]=function(){return this.tree[e].apply(this.tree,arguments)}}),t.exports=a},{"./bst":12,"./customUtils":13,underscore:15,util:21}],12:[function(e,t,n){var r=e("./customUtils");function i(e){e=e||{},this.left=null,this.right=null,this.parent=void 0!==e.parent?e.parent:null,e.hasOwnProperty("key")&&(this.key=e.key),this.data=e.hasOwnProperty("value")?[e.value]:[],this.unique=e.unique||!1,this.compareKeys=e.compareKeys||r.defaultCompareKeysFunction,this.checkValueEquality=e.checkValueEquality||r.defaultCheckValueEquality}function o(e,t){var n;for(n=0;n<t.length;n+=1)e.push(t[n])}i.prototype.getMaxKeyDescendant=function(){return this.right?this.right.getMaxKeyDescendant():this},i.prototype.getMaxKey=function(){return this.getMaxKeyDescendant().key},i.prototype.getMinKeyDescendant=function(){return this.left?this.left.getMinKeyDescendant():this},i.prototype.getMinKey=function(){return this.getMinKeyDescendant().key},i.prototype.checkAllNodesFullfillCondition=function(e){this.hasOwnProperty("key")&&(e(this.key,this.data),this.left&&this.left.checkAllNodesFullfillCondition(e),this.right&&this.right.checkAllNodesFullfillCondition(e))},i.prototype.checkNodeOrdering=function(){var t=this;this.hasOwnProperty("key")&&(this.left&&(this.left.checkAllNodesFullfillCondition(function(e){if(0<=t.compareKeys(e,t.key))throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.left.checkNodeOrdering()),this.right&&(this.right.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)<=0)throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.right.checkNodeOrdering()))},i.prototype.checkInternalPointers=function(){if(this.left){if(this.left.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.left.checkInternalPointers()}if(this.right){if(this.right.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.right.checkInternalPointers()}},i.prototype.checkIsBST=function(){if(this.checkNodeOrdering(),this.checkInternalPointers(),this.parent)throw new Error("The root shouldn't have a parent")},i.prototype.getNumberOfKeys=function(){var e;return this.hasOwnProperty("key")?(e=1,this.left&&(e+=this.left.getNumberOfKeys()),this.right&&(e+=this.right.getNumberOfKeys()),e):0},i.prototype.createSimilar=function(e){return(e=e||{}).unique=this.unique,e.compareKeys=this.compareKeys,e.checkValueEquality=this.checkValueEquality,new this.constructor(e)},i.prototype.createLeftChild=function(e){var t=this.createSimilar(e);return(t.parent=this).left=t},i.prototype.createRightChild=function(e){var t=this.createSimilar(e);return(t.parent=this).right=t},i.prototype.insert=function(e,t){if(!this.hasOwnProperty("key"))return this.key=e,void this.data.push(t);if(0!==this.compareKeys(this.key,e))this.compareKeys(e,this.key)<0?this.left?this.left.insert(e,t):this.createLeftChild({key:e,value:t}):this.right?this.right.insert(e,t):this.createRightChild({key:e,value:t});else{if(this.unique){var n=new Error("Can't insert key "+e+", it violates the unique constraint");throw n.key=e,n.errorType="uniqueViolated",n}this.data.push(t)}},i.prototype.search=function(e){return this.hasOwnProperty("key")?0===this.compareKeys(this.key,e)?this.data:this.compareKeys(e,this.key)<0?this.left?this.left.search(e):[]:this.right?this.right.search(e):[]:[]},i.prototype.getLowerBoundMatcher=function(t){var n=this;return t.hasOwnProperty("$gt")||t.hasOwnProperty("$gte")?t.hasOwnProperty("$gt")&&t.hasOwnProperty("$gte")?0===n.compareKeys(t.$gte,t.$gt)?function(e){return 0<n.compareKeys(e,t.$gt)}:0<n.compareKeys(t.$gte,t.$gt)?function(e){return 0<=n.compareKeys(e,t.$gte)}:function(e){return 0<n.compareKeys(e,t.$gt)}:t.hasOwnProperty("$gt")?function(e){return 0<n.compareKeys(e,t.$gt)}:function(e){return 0<=n.compareKeys(e,t.$gte)}:function(){return!0}},i.prototype.getUpperBoundMatcher=function(t){var n=this;return t.hasOwnProperty("$lt")||t.hasOwnProperty("$lte")?t.hasOwnProperty("$lt")&&t.hasOwnProperty("$lte")?0===n.compareKeys(t.$lte,t.$lt)?function(e){return n.compareKeys(e,t.$lt)<0}:n.compareKeys(t.$lte,t.$lt)<0?function(e){return n.compareKeys(e,t.$lte)<=0}:function(e){return n.compareKeys(e,t.$lt)<0}:t.hasOwnProperty("$lt")?function(e){return n.compareKeys(e,t.$lt)<0}:function(e){return n.compareKeys(e,t.$lte)<=0}:function(){return!0}},i.prototype.betweenBounds=function(e,t,n){var r=[];return this.hasOwnProperty("key")?(t=t||this.getLowerBoundMatcher(e),n=n||this.getUpperBoundMatcher(e),t(this.key)&&this.left&&o(r,this.left.betweenBounds(e,t,n)),t(this.key)&&n(this.key)&&o(r,this.data),n(this.key)&&this.right&&o(r,this.right.betweenBounds(e,t,n)),r):[]},i.prototype.deleteIfLeaf=function(){return!this.left&&!this.right&&(this.parent?this.parent.left===this?this.parent.left=null:this.parent.right=null:(delete this.key,this.data=[]),!0)},i.prototype.deleteIfOnlyOneChild=function(){var e;return this.left&&!this.right&&(e=this.left),!this.left&&this.right&&(e=this.right),!!e&&(this.parent?this.parent.left===this?(this.parent.left=e).parent=this.parent:(this.parent.right=e).parent=this.parent:(this.key=e.key,this.data=e.data,this.left=null,e.left&&(this.left=e.left,e.left.parent=this),this.right=null,e.right&&(this.right=e.right,e.right.parent=this)),!0)},i.prototype.delete=function(e,t){var n,r=[],i=this;if(this.hasOwnProperty("key"))if(this.compareKeys(e,this.key)<0)this.left&&this.left.delete(e,t);else if(0<this.compareKeys(e,this.key))this.right&&this.right.delete(e,t);else if(0!==!this.compareKeys(e,this.key))return 1<this.data.length&&void 0!==t?(this.data.forEach(function(e){i.checkValueEquality(e,t)||r.push(e)}),void(i.data=r)):void(this.deleteIfLeaf()||this.deleteIfOnlyOneChild()||(.5<=Math.random()?(n=this.left.getMaxKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?this.left=n.left:n.parent.right=n.left,n.left&&(n.left.parent=n.parent)):(n=this.right.getMinKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?this.right=n.right:n.parent.left=n.right,n.right&&(n.right.parent=n.parent))))},i.prototype.executeOnEveryNode=function(e){this.left&&this.left.executeOnEveryNode(e),e(this),this.right&&this.right.executeOnEveryNode(e)},i.prototype.prettyPrint=function(e,t){t=t||"",console.log(t+"* "+this.key),e&&console.log(t+"* "+this.data),(this.left||this.right)&&(this.left?this.left.prettyPrint(e,t+"  "):console.log(t+"  *"),this.right?this.right.prettyPrint(e,t+"  "):console.log(t+"  *"))},t.exports=i},{"./customUtils":13}],13:[function(e,t,n){t.exports.getRandomArray=function e(t){var n,r;return 0===t?[]:1===t?[0]:(n=e(t-1),r=Math.floor(Math.random()*t),n.splice(r,0,t-1),n)},t.exports.defaultCompareKeysFunction=function(e,t){if(e<t)return-1;if(t<e)return 1;if(e===t)return 0;var n=new Error("Couldn't compare elements");throw n.a=e,n.b=t,n},t.exports.defaultCheckValueEquality=function(e,t){return e===t}},{}],14:[function(l,t,n){(function(r){!function(e){"object"==typeof n&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this).localforage=e()}(function(){return function o(a,u,s){function c(n,e){if(!u[n]){if(!a[n]){var t="function"==typeof l&&l;if(!e&&t)return t(n,!0);if(f)return f(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var i=u[n]={exports:{}};a[n][0].call(i.exports,function(e){var t=a[n][1][e];return c(t||e)},i,i.exports,o,a,u,s)}return u[n].exports}for(var f="function"==typeof l&&l,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,f,t){(function(t){"use strict";var n,r,e=t.MutationObserver||t.WebKitMutationObserver;if(e){var i=0,o=new e(c),a=t.document.createTextNode("");o.observe(a,{characterData:!0}),n=function(){a.data=i=++i%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){c(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(c,0)};else{var u=new t.MessageChannel;u.port1.onmessage=c,n=function(){u.port2.postMessage(0)}}var s=[];function c(){var e,t;r=!0;for(var n=s.length;n;){for(t=s,s=[],e=-1;++e<n;)t[e]();n=s.length}r=!1}f.exports=function(e){1!==s.push(e)||r||n()}}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var i=e(1);function c(){}var f={},o=["REJECTED"],a=["FULFILLED"],r=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=r,this.queue=[],this.outcome=void 0,e!==c&&p(this,e)}function s(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function l(t,n,r){i(function(){var e;try{e=n(r)}catch(e){return f.reject(t,e)}e===t?f.reject(t,new TypeError("Cannot resolve promise with itself")):f.resolve(t,e)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(t,e){var n=!1;function r(e){n||(n=!0,f.reject(t,e))}function i(e){n||(n=!0,f.resolve(t,e))}var o=d(function(){e(i,r)});"error"===o.status&&r(o.value)}function d(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=u).prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(c);this.state!==r?l(n,this.state===a?e:t,this.outcome):this.queue.push(new s(n,e,t));return n},s.prototype.callFulfilled=function(e){f.resolve(this.promise,e)},s.prototype.otherCallFulfilled=function(e){l(this.promise,this.onFulfilled,e)},s.prototype.callRejected=function(e){f.reject(this.promise,e)},s.prototype.otherCallRejected=function(e){l(this.promise,this.onRejected,e)},f.resolve=function(e,t){var n=d(h,t);if("error"===n.status)return f.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=a,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},f.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){if(e instanceof this)return e;return f.resolve(new this(c),e)},u.reject=function(e){var t=new this(c);return f.reject(t,e)},u.all=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);var o=new Array(r),a=0,t=-1,u=new this(c);for(;++t<r;)s(e[t],t);return u;function s(e,t){n.resolve(e).then(function(e){o[t]=e,++a!==r||i||(i=!0,f.resolve(u,o))},function(e){i||(i=!0,f.reject(u,e))})}},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);var i=-1,o=new this(c);for(;++i<n;)a=e[i],t.resolve(a).then(function(e){r||(r=!0,f.resolve(o,e))},function(e){r||(r=!0,f.reject(o,e))});var a;return o}},{1:1}],3:[function(t,e,n){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var u=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function a(t,n){t=t||[],n=n||{};try{return new Blob(t,n)}catch(e){if("TypeError"!==e.name)throw e;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<t.length;i+=1)r.append(t[i]);return r.getBlob(n.type)}}"undefined"==typeof Promise&&e(3);var l=Promise;function h(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function s(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function p(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function o(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var c="local-forage-detect-blob-support",i=void 0,f={},d=Object.prototype.toString,y="readonly",v="readwrite";function g(e){return"boolean"==typeof i?l.resolve(i):(r=e,new l(function(n){var e=r.transaction(c,v),t=a([""]);e.objectStore(c).put(t,"key"),e.onabort=function(e){e.preventDefault(),e.stopPropagation(),n(!1)},e.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),t=navigator.userAgent.match(/Edge\//);n(t||!e||43<=parseInt(e[1],10))}}).catch(function(){return!1})).then(function(e){return i=e});var r}function m(e){var t=f[e.name],n={};n.promise=new l(function(e,t){n.resolve=e,n.reject=t}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function b(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function w(e,t){var n=f[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function _(i,o){return new l(function(e,t){if(f[i.name]=f[i.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},i.db){if(!o)return e(i.db);m(i),i.db.close()}var n=[i.name];o&&n.push(i.version);var r=u.open.apply(u,n);o&&(r.onupgradeneeded=function(t){var e=r.result;try{e.createObjectStore(i.storeName),t.oldVersion<=1&&e.createObjectStore(c)}catch(e){if("ConstraintError"!==e.name)throw e;console.warn('The database "'+i.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+i.storeName+'" already exists.')}}),r.onerror=function(e){e.preventDefault(),t(r.error)},r.onsuccess=function(){e(r.result),b(i)}})}function k(e){return _(e,!1)}function x(e){return _(e,!0)}function E(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function O(e){return a([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}(atob(e.data))],{type:e.type})}function A(e){return e&&e.__local_forage_encoded_blob}function I(e){var t=this,n=t._initReady().then(function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return s(n,e,e),n}function j(t,n,r,i){void 0===i&&(i=1);try{var e=t.db.transaction(t.storeName,n);r(null,e)}catch(e){if(0<i&&(!t.db||"InvalidStateError"===e.name||"NotFoundError"===e.name))return l.resolve().then(function(){if(!t.db||"NotFoundError"===e.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),x(t)}).then(function(){return function(n){m(n);for(var r=f[n.name],i=r.forages,e=0;e<i.length;e++){var t=i[e];t._dbInfo.db&&(t._dbInfo.db.close(),t._dbInfo.db=null)}return n.db=null,k(n).then(function(e){return n.db=e,E(n)?x(n):e}).then(function(e){n.db=r.db=e;for(var t=0;t<i.length;t++)i[t]._dbInfo.db=e}).catch(function(e){throw w(n,e),e})}(t).then(function(){j(t,n,r,i-1)})}).catch(r);r(e)}}var S={_driver:"asyncStorage",_initStorage:function(e){var r=this,i={db:null};if(e)for(var t in e)i[t]=e[t];var o=f[i.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},f[i.name]=o),o.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=I);var n=[];function a(){return l.resolve()}for(var u=0;u<o.forages.length;u++){var s=o.forages[u];s!==r&&n.push(s._initReady().catch(a))}var c=o.forages.slice(0);return l.all(n).then(function(){return i.db=o.db,k(i)}).then(function(e){return i.db=e,E(i,r._defaultConfig.version)?x(i):e}).then(function(e){i.db=o.db=e,r._dbInfo=i;for(var t=0;t<c.length;t++){var n=c[t];n!==r&&(n._dbInfo.db=i.db,n._dbInfo.version=i.version)}})},_support:function(){try{if(!u)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(a,e){var u=this,t=new l(function(o,n){u.ready().then(function(){j(u._dbInfo,y,function(e,t){if(e)return n(e);try{var r=t.objectStore(u._dbInfo.storeName).openCursor(),i=1;r.onsuccess=function(){var e=r.result;if(e){var t=e.value;A(t)&&(t=O(t));var n=a(t,e.key,i++);void 0!==n?o(n):e.continue()}else o()},r.onerror=function(){n(r.error)}}catch(e){n(e)}})}).catch(n)});return h(t,e),t},getItem:function(o,e){var a=this;o=p(o);var t=new l(function(r,i){a.ready().then(function(){j(a._dbInfo,y,function(e,t){if(e)return i(e);try{var n=t.objectStore(a._dbInfo.storeName).get(o);n.onsuccess=function(){var e=n.result;void 0===e&&(e=null),A(e)&&(e=O(e)),r(e)},n.onerror=function(){i(n.error)}}catch(e){i(e)}})}).catch(i)});return h(t,e),t},setItem:function(u,t,e){var s=this;u=p(u);var n=new l(function(o,a){var e;s.ready().then(function(){return e=s._dbInfo,"[object Blob]"===d.call(t)?g(e.db).then(function(e){return e?t:(r=t,new l(function(n,e){var t=new FileReader;t.onerror=e,t.onloadend=function(e){var t=btoa(e.target.result||"");n({__local_forage_encoded_blob:!0,data:t,type:r.type})},t.readAsBinaryString(r)}));var r}):t}).then(function(i){j(s._dbInfo,v,function(e,t){if(e)return a(e);try{var n=t.objectStore(s._dbInfo.storeName);null===i&&(i=void 0);var r=n.put(i,u);t.oncomplete=function(){void 0===i&&(i=null),o(i)},t.onabort=t.onerror=function(){var e=r.error?r.error:r.transaction.error;a(e)}}catch(e){a(e)}})}).catch(a)});return h(n,e),n},removeItem:function(o,e){var a=this;o=p(o);var t=new l(function(r,i){a.ready().then(function(){j(a._dbInfo,v,function(e,t){if(e)return i(e);try{var n=t.objectStore(a._dbInfo.storeName).delete(o);t.oncomplete=function(){r()},t.onerror=function(){i(n.error)},t.onabort=function(){var e=n.error?n.error:n.transaction.error;i(e)}}catch(e){i(e)}})}).catch(i)});return h(t,e),t},clear:function(e){var o=this,t=new l(function(r,i){o.ready().then(function(){j(o._dbInfo,v,function(e,t){if(e)return i(e);try{var n=t.objectStore(o._dbInfo.storeName).clear();t.oncomplete=function(){r()},t.onabort=t.onerror=function(){var e=n.error?n.error:n.transaction.error;i(e)}}catch(e){i(e)}})}).catch(i)});return h(t,e),t},length:function(e){var o=this,t=new l(function(r,i){o.ready().then(function(){j(o._dbInfo,y,function(e,t){if(e)return i(e);try{var n=t.objectStore(o._dbInfo.storeName).count();n.onsuccess=function(){r(n.result)},n.onerror=function(){i(n.error)}}catch(e){i(e)}})}).catch(i)});return h(t,e),t},key:function(u,e){var s=this,t=new l(function(o,a){u<0?o(null):s.ready().then(function(){j(s._dbInfo,y,function(e,t){if(e)return a(e);try{var n=t.objectStore(s._dbInfo.storeName),r=!1,i=n.openCursor();i.onsuccess=function(){var e=i.result;e?0===u?o(e.key):r?o(e.key):(r=!0,e.advance(u)):o(null)},i.onerror=function(){a(i.error)}}catch(e){a(e)}})}).catch(a)});return h(t,e),t},keys:function(e){var a=this,t=new l(function(i,o){a.ready().then(function(){j(a._dbInfo,y,function(e,t){if(e)return o(e);try{var n=t.objectStore(a._dbInfo.storeName).openCursor(),r=[];n.onsuccess=function(){var e=n.result;e?(r.push(e.key),e.continue()):i(r)},n.onerror=function(){o(n.error)}}catch(e){o(e)}})}).catch(o)});return h(t,e),t},dropInstance:function(a,e){e=o.apply(this,arguments);var t,n=this.config();if((a="function"!=typeof a&&a||{}).name||(a.name=a.name||n.name,a.storeName=a.storeName||n.storeName),a.name){var r=a.name===n.name&&this._dbInfo.db?l.resolve(this._dbInfo.db):k(a).then(function(e){var t=f[a.name],n=t.forages;t.db=e;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=e;return e});t=a.storeName?r.then(function(e){if(e.objectStoreNames.contains(a.storeName)){var i=e.version+1;m(a);var r=f[a.name],o=r.forages;e.close();for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=null,n._dbInfo.version=i}return new l(function(t,n){var r=u.open(a.name,i);r.onerror=function(e){r.result.close(),n(e)},r.onupgradeneeded=function(){r.result.deleteObjectStore(a.storeName)},r.onsuccess=function(){var e=r.result;e.close(),t(e)}}).then(function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,b(n._dbInfo)}}).catch(function(e){throw(w(a,e)||l.resolve()).catch(function(){}),e})}}):r.then(function(e){m(a);var n=f[a.name],r=n.forages;e.close();for(var t=0;t<r.length;t++)r[t]._dbInfo.db=null;return new l(function(t,n){var r=u.deleteDatabase(a.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}).then(function(e){n.db=e;for(var t=0;t<r.length;t++)b(r[t]._dbInfo)}).catch(function(e){throw(w(a,e)||l.resolve()).catch(function(){}),e})})}else t=l.reject("Invalid arguments");return h(t,e),t}};var D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$=/^~~local_forage_type~([^~]+)~/,N="__lfsc__:",T=N.length,C="arbf",M="blob",R=T+C.length,L=Object.prototype.toString;function F(e){var t,n,r,i,o,a=.75*e.length,u=e.length,s=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),f=new Uint8Array(c);for(t=0;t<u;t+=4)n=D.indexOf(e[t]),r=D.indexOf(e[t+1]),i=D.indexOf(e[t+2]),o=D.indexOf(e[t+3]),f[s++]=n<<2|r>>4,f[s++]=(15&r)<<4|i>>2,f[s++]=(3&i)<<6|63&o;return c}function B(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=D[n[t]>>2],r+=D[(3&n[t])<<4|n[t+1]>>4],r+=D[(15&n[t+1])<<2|n[t+2]>>6],r+=D[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var z={serialize:function(t,n){var e="";if(t&&(e=L.call(t)),t&&("[object ArrayBuffer]"===e||t.buffer&&"[object ArrayBuffer]"===L.call(t.buffer))){var r,i=N;t instanceof ArrayBuffer?(r=t,i+=C):(r=t.buffer,"[object Int8Array]"===e?i+="si08":"[object Uint8Array]"===e?i+="ui08":"[object Uint8ClampedArray]"===e?i+="uic8":"[object Int16Array]"===e?i+="si16":"[object Uint16Array]"===e?i+="ur16":"[object Int32Array]"===e?i+="si32":"[object Uint32Array]"===e?i+="ui32":"[object Float32Array]"===e?i+="fl32":"[object Float64Array]"===e?i+="fl64":n(new Error("Failed to get type for BinaryArray"))),n(i+B(r))}else if("[object Blob]"===e){var o=new FileReader;o.onload=function(){var e="~~local_forage_type~"+t.type+"~"+B(this.result);n(N+M+e)},o.readAsArrayBuffer(t)}else try{n(JSON.stringify(t))}catch(e){console.error("Couldn't convert value into a JSON string: ",t),n(null,e)}},deserialize:function(e){if(e.substring(0,T)!==N)return JSON.parse(e);var t,n=e.substring(R),r=e.substring(T,R);if(r===M&&$.test(n)){var i=n.match($);t=i[1],n=n.substring(i[0].length)}var o=F(n);switch(r){case C:return o;case M:return a([o],{type:t});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+r)}},stringToBuffer:F,bufferToString:B};function P(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function q(e,r,i,o,a,u){e.executeSql(i,o,a,function(e,n){n.code===n.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[r.storeName],function(e,t){t.rows.length?u(e,n):P(e,r,function(){e.executeSql(i,o,a,u)},u)},u):u(e,n)},u)}var K={_driver:"webSQLStorage",_initStorage:function(e){var r=this,i={db:null};if(e)for(var t in e)i[t]="string"!=typeof e[t]?e[t].toString():e[t];var n=new l(function(t,n){try{i.db=openDatabase(i.name,String(i.version),i.description,i.size)}catch(e){return n(e)}i.db.transaction(function(e){P(e,i,function(){r._dbInfo=i,t()},function(e,t){n(t)})},n)});return i.serializer=z,n},_support:"function"==typeof openDatabase,iterate:function(c,e){var t=this,n=new l(function(s,n){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(e){q(e,u,"SELECT * FROM "+u.storeName,[],function(e,t){for(var n=t.rows,r=n.length,i=0;i<r;i++){var o=n.item(i),a=o.value;if(a&&(a=u.serializer.deserialize(a)),void 0!==(a=c(a,o.key,i+1)))return void s(a)}s()},function(e,t){n(t)})})}).catch(n)});return h(n,e),n},getItem:function(t,e){var o=this;t=p(t);var n=new l(function(i,n){o.ready().then(function(){var r=o._dbInfo;r.db.transaction(function(e){q(e,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[t],function(e,t){var n=t.rows.length?t.rows.item(0).value:null;n&&(n=r.serializer.deserialize(n)),i(n)},function(e,t){n(t)})})}).catch(n)});return h(n,e),n},setItem:function(e,t,n){return function a(u,e,s,c){var f=this;u=p(u);var t=new l(function(i,o){f.ready().then(function(){void 0===e&&(e=null);var n=e,r=f._dbInfo;r.serializer.serialize(e,function(t,e){e?o(e):r.db.transaction(function(e){q(e,r,"INSERT OR REPLACE INTO "+r.storeName+" (key, value) VALUES (?, ?)",[u,t],function(){i(n)},function(e,t){o(t)})},function(e){if(e.code===e.QUOTA_ERR){if(0<c)return void i(a.apply(f,[u,n,s,c-1]));o(e)}})})}).catch(o)});return h(t,s),t}.apply(this,[e,t,n,1])},removeItem:function(i,e){var o=this;i=p(i);var t=new l(function(n,r){o.ready().then(function(){var t=o._dbInfo;t.db.transaction(function(e){q(e,t,"DELETE FROM "+t.storeName+" WHERE key = ?",[i],function(){n()},function(e,t){r(t)})})}).catch(r)});return h(t,e),t},clear:function(e){var i=this,t=new l(function(n,r){i.ready().then(function(){var t=i._dbInfo;t.db.transaction(function(e){q(e,t,"DELETE FROM "+t.storeName,[],function(){n()},function(e,t){r(t)})})}).catch(r)});return h(t,e),t},length:function(e){var i=this,t=new l(function(r,n){i.ready().then(function(){var t=i._dbInfo;t.db.transaction(function(e){q(e,t,"SELECT COUNT(key) as c FROM "+t.storeName,[],function(e,t){var n=t.rows.item(0).c;r(n)},function(e,t){n(t)})})}).catch(n)});return h(t,e),t},key:function(i,e){var o=this,t=new l(function(r,n){o.ready().then(function(){var t=o._dbInfo;t.db.transaction(function(e){q(e,t,"SELECT key FROM "+t.storeName+" WHERE id = ? LIMIT 1",[i+1],function(e,t){var n=t.rows.length?t.rows.item(0).key:null;r(n)},function(e,t){n(t)})})}).catch(n)});return h(t,e),t},keys:function(e){var r=this,t=new l(function(i,n){r.ready().then(function(){var t=r._dbInfo;t.db.transaction(function(e){q(e,t,"SELECT key FROM "+t.storeName,[],function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).key);i(n)},function(e,t){n(t)})})}).catch(n)});return h(t,e),t},dropInstance:function(n,e){e=o.apply(this,arguments);var r=this.config();(n="function"!=typeof n&&n||{}).name||(n.name=n.name||r.name,n.storeName=n.storeName||r.storeName);var t,i=this;return h(t=n.name?new l(function(e){var t,o;t=n.name===r.name?i._dbInfo.db:openDatabase(n.name,"","",0),n.storeName?e({db:t,storeNames:[n.storeName]}):e((o=t,new l(function(i,n){o.transaction(function(e){e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).name);i({db:o,storeNames:n})},function(e,t){n(t)})},function(e){n(e)})})))}).then(function(u){return new l(function(o,a){u.db.transaction(function(r){function e(t){return new l(function(e,n){r.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(e,t){n(t)})})}for(var t=[],n=0,i=u.storeNames.length;n<i;n++)t.push(e(u.storeNames[n]));l.all(t).then(function(){o()}).catch(function(e){a(e)})},function(e){a(e)})})}):l.reject("Invalid arguments"),e),t}};function U(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function V(){return!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}()||0<localStorage.length}var H={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=U(e,this._defaultConfig),V()?((this._dbInfo=t).serializer=z,l.resolve()):l.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(s,e){var c=this,t=c.ready().then(function(){for(var e=c._dbInfo,t=e.keyPrefix,n=t.length,r=localStorage.length,i=1,o=0;o<r;o++){var a=localStorage.key(o);if(0===a.indexOf(t)){var u=localStorage.getItem(a);if(u&&(u=e.serializer.deserialize(u)),void 0!==(u=s(u,a.substring(n),i++)))return u}}});return h(t,e),t},getItem:function(n,e){var r=this;n=p(n);var t=r.ready().then(function(){var e=r._dbInfo,t=localStorage.getItem(e.keyPrefix+n);return t&&(t=e.serializer.deserialize(t)),t});return h(t,e),t},setItem:function(a,e,t){var u=this;a=p(a);var n=u.ready().then(function(){void 0===e&&(e=null);var o=e;return new l(function(n,r){var i=u._dbInfo;i.serializer.serialize(e,function(e,t){if(t)r(t);else try{localStorage.setItem(i.keyPrefix+a,e),n(o)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||r(e),r(e)}})})});return h(n,t),n},removeItem:function(t,e){var n=this;t=p(t);var r=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return h(r,e),r},clear:function(e){var r=this,t=r.ready().then(function(){for(var e=r._dbInfo.keyPrefix,t=localStorage.length-1;0<=t;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}});return h(t,e),t},length:function(e){var t=this.keys().then(function(e){return e.length});return h(t,e),t},key:function(n,e){var r=this,t=r.ready().then(function(){var t,e=r._dbInfo;try{t=localStorage.key(n)}catch(e){t=null}return t&&(t=t.substring(e.keyPrefix.length)),t});return h(t,e),t},keys:function(e){var o=this,t=o.ready().then(function(){for(var e=o._dbInfo,t=localStorage.length,n=[],r=0;r<t;r++){var i=localStorage.key(r);0===i.indexOf(e.keyPrefix)&&n.push(i.substring(e.keyPrefix.length))}return n});return h(t,e),t},dropInstance:function(t,e){if(e=o.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var r,i=this;return h(r=t.name?new l(function(e){t.storeName?e(U(t,i._defaultConfig)):e(t.name+"/")}).then(function(e){for(var t=localStorage.length-1;0<=t;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}}):l.reject("Invalid arguments"),e),r}},W=function(e,t){for(var n,r,i=e.length,o=0;o<i;){if((n=e[o])===(r=t)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;o++}return!1},G=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},J={},Q={},Y={INDEXEDDB:S,WEBSQL:K,LOCALSTORAGE:H},X=[Y.INDEXEDDB._driver,Y.WEBSQL._driver,Y.LOCALSTORAGE._driver],Z=["dropInstance"],ee=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Z),te={description:"",driver:X.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ne(t,n){t[n]=function(){var e=arguments;return t.ready().then(function(){return t[n].apply(t,e)})}}function re(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(G(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var ie=new(function(){function i(e){for(var t in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Y)if(Y.hasOwnProperty(t)){var n=Y[t],r=n._driver;this[t]=r,J[r]||this.defineDriver(n)}this._defaultConfig=re({},te),this._config=re({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return i.prototype.config=function(e){if("object"!==(void 0===e?"undefined":r(e)))return"string"==typeof e?this._config[e]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)},i.prototype.defineDriver=function(c,e,t){var n=new l(function(t,n){try{var r=c._driver,e=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!c._driver)return void n(e);for(var i=ee.concat("_initStorage"),o=0,a=i.length;o<a;o++){var u=i[o];if((!W(Z,u)||c[u])&&"function"!=typeof c[u])return void n(e)}!function(){for(var e=function(n){return function(){var e=new Error("Method "+n+" is not implemented by the current driver"),t=l.reject(e);return h(t,arguments[arguments.length-1]),t}},t=0,n=Z.length;t<n;t++){var r=Z[t];c[r]||(c[r]=e(r))}}();var s=function(e){J[r]&&console.info("Redefining LocalForage driver: "+r),J[r]=c,Q[r]=e,t()};"_support"in c?c._support&&"function"==typeof c._support?c._support().then(s,n):s(!!c._support):s(!0)}catch(e){n(e)}});return s(n,e,t),n},i.prototype.driver=function(){return this._driver||null},i.prototype.getDriver=function(e,t,n){var r=J[e]?l.resolve(J[e]):l.reject(new Error("Driver not found."));return s(r,t,n),r},i.prototype.getSerializer=function(e){var t=l.resolve(z);return s(t,e),t},i.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return s(n,e,e),n},i.prototype.setDriver=function(e,t,n){var o=this;G(e)||(e=[e]);var r=this._getSupportedDrivers(e);function a(){o._config.driver=o.driver()}function u(e){return o._extend(e),a(),o._ready=o._initStorage(o._config),o._ready}var i=null!==this._driverSet?this._driverSet.catch(function(){return l.resolve()}):l.resolve();return this._driverSet=i.then(function(){var e=r[0];return o._dbInfo=null,o._ready=null,o.getDriver(e).then(function(e){var i;o._driver=e._driver,a(),o._wrapLibraryMethodsWithReady(),o._initDriver=(i=r,function(){var r=0;return function e(){for(;r<i.length;){var t=i[r];return r++,o._dbInfo=null,o._ready=null,o.getDriver(t).then(u).catch(e)}a();var n=new Error("No available storage method found.");return o._driverSet=l.reject(n),o._driverSet}()})})}).catch(function(){a();var e=new Error("No available storage method found.");return o._driverSet=l.reject(e),o._driverSet}),s(this._driverSet,t,n),this._driverSet},i.prototype.supports=function(e){return!!Q[e]},i.prototype._extend=function(e){re(this,e)},i.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},i.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ee.length;e<t;e++)ne(this,ee[e])},i.prototype.createInstance=function(e){return new i(e)},i}());t.exports=ie},{3:3}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(e,F,B){(function(){var e=this,t=e._,a={},i=Array.prototype,n=Object.prototype,r=Function.prototype,o=i.push,u=i.slice,s=i.concat,l=n.toString,c=n.hasOwnProperty,f=i.forEach,h=i.map,p=i.reduce,d=i.reduceRight,y=i.filter,v=i.every,g=i.some,m=i.indexOf,b=i.lastIndexOf,w=Array.isArray,_=Object.keys,k=r.bind,x=function(e){return e instanceof x?e:this instanceof x?void(this._wrapped=e):new x(e)};void 0!==B?(void 0!==F&&F.exports&&(B=F.exports=x),B._=x):e._=x,x.VERSION="1.4.4";var E=x.each=x.forEach=function(e,t,n){if(null!=e)if(f&&e.forEach===f)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e)===a)return}else for(var o in e)if(x.has(e,o)&&t.call(n,e[o],o,e)===a)return};x.map=x.collect=function(e,r,i){var o=[];return null==e?o:h&&e.map===h?e.map(r,i):(E(e,function(e,t,n){o[o.length]=r.call(i,e,t,n)}),o)};var O="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,r,i,o){var a=2<arguments.length;if(null==e&&(e=[]),p&&e.reduce===p)return o&&(r=x.bind(r,o)),a?e.reduce(r,i):e.reduce(r);if(E(e,function(e,t,n){a?i=r.call(o,i,e,t,n):(i=e,a=!0)}),!a)throw new TypeError(O);return i},x.reduceRight=x.foldr=function(r,i,o,a){var u=2<arguments.length;if(null==r&&(r=[]),d&&r.reduceRight===d)return a&&(i=x.bind(i,a)),u?r.reduceRight(i,o):r.reduceRight(i);var s=r.length;if(s!==+s){var c=x.keys(r);s=c.length}if(E(r,function(e,t,n){t=c?c[--s]:--s,u?o=i.call(a,o,r[t],t,n):(o=r[t],u=!0)}),!u)throw new TypeError(O);return o},x.find=x.detect=function(e,r,i){var o;return A(e,function(e,t,n){if(r.call(i,e,t,n))return o=e,!0}),o},x.filter=x.select=function(e,r,i){var o=[];return null==e?o:y&&e.filter===y?e.filter(r,i):(E(e,function(e,t,n){r.call(i,e,t,n)&&(o[o.length]=e)}),o)},x.reject=function(e,r,i){return x.filter(e,function(e,t,n){return!r.call(i,e,t,n)},i)},x.every=x.all=function(e,r,i){r||(r=x.identity);var o=!0;return null==e?o:v&&e.every===v?e.every(r,i):(E(e,function(e,t,n){if(!(o=o&&r.call(i,e,t,n)))return a}),!!o)};var A=x.some=x.any=function(e,r,i){r||(r=x.identity);var o=!1;return null==e?o:g&&e.some===g?e.some(r,i):(E(e,function(e,t,n){if(o||(o=r.call(i,e,t,n)))return a}),!!o)};x.contains=x.include=function(e,t){return null!=e&&(m&&e.indexOf===m?-1!=e.indexOf(t):A(e,function(e){return e===t}))},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,n,t){return x.isEmpty(n)?t?null:[]:x[t?"find":"filter"](e,function(e){for(var t in n)if(n[t]!==e[t])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,i,o){if(!i&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!i&&x.isEmpty(e))return-1/0;var a={computed:-1/0,value:-1/0};return E(e,function(e,t,n){var r=i?i.call(o,e,t,n):e;r>=a.computed&&(a={value:e,computed:r})}),a.value},x.min=function(e,i,o){if(!i&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!i&&x.isEmpty(e))return 1/0;var a={computed:1/0,value:1/0};return E(e,function(e,t,n){var r=i?i.call(o,e,t,n):e;r<a.computed&&(a={value:e,computed:r})}),a.value},x.shuffle=function(e){var t,n=0,r=[];return E(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var I=function(t){return x.isFunction(t)?t:function(e){return e[t]}};x.sortBy=function(e,t,r){var i=I(t);return x.pluck(x.map(e,function(e,t,n){return{value:e,index:t,criteria:i.call(r,e,t,n)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index<t.index?-1:1}),"value")};var j=function(r,e,i,o){var a={},u=I(e||x.identity);return E(r,function(e,t){var n=u.call(i,e,t,r);o(a,n,e)}),a};x.groupBy=function(e,t,n){return j(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return j(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){for(var i=(n=null==n?x.identity:I(n)).call(r,t),o=0,a=e.length;o<a;){var u=o+a>>>1;n.call(r,e[u])<i?o=u+1:a=u}return o},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){if(null!=e)return null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){if(null!=e)return null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var S=function(e,t,n){return E(e,function(e){x.isArray(e)?t?o.apply(n,e):S(e,t,n):n.push(e)}),n};x.flatten=function(e,t){return S(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(n,r,e,t){x.isFunction(r)&&(t=e,e=r,r=!1);var i=e?x.map(n,e,t):n,o=[],a=[];return E(i,function(e,t){(r?t&&a[a.length-1]===e:x.contains(a,e))||(a.push(e),o.push(n[t]))}),o},x.union=function(){return x.uniq(s.apply(i,arguments))},x.intersection=function(e){var n=u.call(arguments,1);return x.filter(x.uniq(e),function(t){return x.every(n,function(e){return 0<=x.indexOf(e,t)})})},x.difference=function(e){var t=s.apply(i,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=u.call(arguments),t=x.max(x.pluck(e,"length")),n=new Array(t),r=0;r<t;r++)n[r]=x.pluck(e,""+r);return n},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return e[r=x.sortedIndex(e,t)]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(m&&e.indexOf===m)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,o=new Array(r);i<r;)o[i++]=e,e+=n;return o},x.bind=function(e,t){if(e.bind===k&&k)return k.apply(e,u.call(arguments,1));var n=u.call(arguments,2);return function(){return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(t){var e=u.call(arguments,1);return 0===e.length&&(e=x.functions(t)),E(e,function(e){t[e]=x.bind(t[e],t)}),t},x.memoize=function(t,n){var r={};return n||(n=x.identity),function(){var e=n.apply(this,arguments);return x.has(r,e)?r[e]:r[e]=t.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(n,r){var i,o,a,u,s=0,c=function(){s=new Date,a=null,u=n.apply(i,o)};return function(){var e=new Date,t=r-(e-s);return i=this,o=arguments,t<=0?(clearTimeout(a),a=null,s=e,u=n.apply(i,o)):a||(a=setTimeout(c,t)),u}},x.debounce=function(r,i,o){var a,u;return function(){var e=this,t=arguments,n=o&&!a;return clearTimeout(a),a=setTimeout(function(){a=null,o||(u=r.apply(e,t))},i),n&&(u=r.apply(e,t)),u}},x.once=function(e){var t,n=!1;return function(){return n||(n=!0,t=e.apply(this,arguments),e=null),t}},x.wrap=function(t,n){return function(){var e=[t];return o.apply(e,arguments),n.apply(this,e)}},x.compose=function(){var n=arguments;return function(){for(var e=arguments,t=n.length-1;0<=t;t--)e=[n[t].apply(this,e)];return e[0]}},x.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},x.keys=_||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&(t[t.length]=n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(n){return E(u.call(arguments,1),function(e){if(e)for(var t in e)n[t]=e[t]}),n},x.pick=function(t){var n={},e=s.apply(i,u.call(arguments,1));return E(e,function(e){e in t&&(n[e]=t[e])}),n},x.omit=function(e){var t={},n=s.apply(i,u.call(arguments,1));for(var r in e)x.contains(n,r)||(t[r]=e[r]);return t},x.defaults=function(n){return E(u.call(arguments,1),function(e){if(e)for(var t in e)null==n[t]&&(n[t]=e[t])}),n},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var D=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]==e)return r[o]==t;n.push(e),r.push(t);var a=0,u=!0;if("[object Array]"==i){if(u=(a=e.length)==t.length)for(;a--&&(u=D(e[a],t[a],n,r)););}else{var s=e.constructor,c=t.constructor;if(s!==c&&!(x.isFunction(s)&&s instanceof s&&x.isFunction(c)&&c instanceof c))return!1;for(var f in e)if(x.has(e,f)&&(a++,!(u=x.has(t,f)&&D(e[f],t[f],n,r))))break;if(u){for(f in t)if(x.has(t,f)&&!a--)break;u=!a}}return n.pop(),r.pop(),u};x.isEqual=function(e,t){return D(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!(!e||1!==e.nodeType)},x.isArray=w||function(e){return"[object Array]"==l.call(e)},x.isObject=function(e){return e===Object(e)},E(["Arguments","Function","String","Number","Date","RegExp"],function(t){x["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!(!e||!x.has(e,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==l.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return c.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(e),i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var $={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};$.unescape=x.invert($.escape);var N={escape:new RegExp("["+x.keys($.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys($.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(t){x[t]=function(e){return null==e?"":(""+e).replace(N[t],function(e){return $[t][e]})}}),x.result=function(e,t){if(null==e)return null;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(n){E(x.functions(n),function(e){var t=x[e]=n[e];x.prototype[e]=function(){var e=[this._wrapped];return o.apply(e,arguments),L.call(this,t.apply(x,e))}})};var T=0;x.uniqueId=function(e){var t=++T+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(o,e,t){var n;t=x.defaults({},t,x.templateSettings);var r=new RegExp([(t.escape||C).source,(t.interpolate||C).source,(t.evaluate||C).source].join("|")+"|$","g"),a=0,u="__p+='";o.replace(r,function(e,t,n,r,i){return u+=o.slice(a,i).replace(R,function(e){return"\\"+M[e]}),t&&(u+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'"),n&&(u+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(u+="';\n"+r+"\n__p+='"),a=i+e.length,e}),u+="';\n",t.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{n=new Function(t.variable||"obj","_",u)}catch(e){throw e.source=u,e}if(e)return n(e,x);var i=function(e){return n.call(this,e,x)};return i.source="function("+(t.variable||"obj")+"){\n"+u+"}",i},x.chain=function(e){return x(e).chain()};var L=function(e){return this._chain?x(e).chain():e};x.mixin(x),E(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=i[t];x.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!=t&&"splice"!=t||0!==e.length||delete e[0],L.call(this,e)}}),E(["concat","join","slice"],function(e){var t=i[e];x.prototype[e]=function(){return L.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}],16:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(e){return"function"==typeof e}function c(e){return"object"==typeof e&&null!==e}function f(e){return void 0===e}((t.exports=r).EventEmitter=r).prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,o,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(f(n=this._events[e]))return!1;if(s(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(c(n))for(i=Array.prototype.slice.call(arguments,1),r=(a=n.slice()).length,o=0;o<r;o++)a[o].apply(this,i);return!0},r.prototype.on=r.prototype.addListener=function(e,t){var n;if(!s(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,s(t.listener)?t.listener:t),this._events[e]?c(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,c(this._events[e])&&!this._events[e].warned&&(n=f(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.once=function(e,t){if(!s(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var n,r,i,o;if(!s(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(n=this._events[e]).length,r=-1,n===t||s(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(c(n)){for(o=i;0<o--;)if(n[o]===t||n[o].listener&&n[o].listener===t){r=o;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(s(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?s(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(s(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],17:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],18:[function(e,t,n){var r,i,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:u}catch(e){i=u}}();var c,f=[],l=!1,h=-1;function p(){l&&c&&(l=!1,c.length?f=c.concat(f):h=-1,f.length&&d())}function d(){if(!l){var e=s(p);l=!0;for(var t=f.length;t;){for(c=f,f=[];++h<t;)c&&c[h].run();h=-1,t=f.length}c=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===u||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function y(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new y(e,t)),1!==f.length||l||s(d)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],19:[function(s,e,c){(function(e,t){var r=s("process/browser.js").nextTick,n=Function.prototype.apply,i=Array.prototype.slice,o={},a=0;function u(e,t){this._id=e,this._clearFn=t}c.setTimeout=function(){return new u(n.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new u(n.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},c.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},c._unrefActive=c.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},c.setImmediate="function"==typeof e?e:function(e){var t=a++,n=!(arguments.length<2)&&i.call(arguments,1);return o[t]=!0,r(function(){o[t]&&(n?e.apply(null,n):e.call(null),c.clearImmediate(t))}),t},c.clearImmediate="function"==typeof t?t:function(e){delete o[e]}}).call(this,s("timers").setImmediate,s("timers").clearImmediate)},{"process/browser.js":18,timers:19}],20:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],21:[function(h,e,I){(function(r,i){var u=/%[sdj%]/g;I.format=function(e){if(!w(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,o=String(e).replace(u,function(e){if("%%"===e)return"%";if(i<=n)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),a=r[n];n<i;a=r[++n])m(a)||!f(a)?o+=" "+a:o+=" "+s(a);return o},I.deprecate=function(e,t){if(_(i.process))return function(){return I.deprecate(e,t).apply(this,arguments)};if(!0===r.noDeprecation)return e;var n=!1;return function(){if(!n){if(r.throwDeprecation)throw new Error(t);r.traceDeprecation?console.trace(t):console.error(t),n=!0}return e.apply(this,arguments)}};var e,o={};function s(e,t){var n={seen:[],stylize:c};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),g(t)?n.showHidden=t:t&&I._extend(n,t),_(n.showHidden)&&(n.showHidden=!1),_(n.depth)&&(n.depth=2),_(n.colors)&&(n.colors=!1),_(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=a),p(n,e,n.depth)}function a(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function c(e,t){return e}function p(t,n,r){if(t.customInspect&&n&&O(n.inspect)&&n.inspect!==I.inspect&&(!n.constructor||n.constructor.prototype!==n)){var e=n.inspect(r,t);return w(e)||(e=p(t,e,r)),e}var i=function(e,t){if(_(t))return e.stylize("undefined","undefined");if(w(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(b(t))return e.stylize(""+t,"number");if(g(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(t,n);if(i)return i;var o,a=Object.keys(n),u=(o={},a.forEach(function(e,t){o[e]=!0}),o);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),E(n)&&(0<=a.indexOf("message")||0<=a.indexOf("description")))return d(n);if(0===a.length){if(O(n)){var s=n.name?": "+n.name:"";return t.stylize("[Function"+s+"]","special")}if(k(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return t.stylize(Date.prototype.toString.call(n),"date");if(E(n))return d(n)}var c,f="",l=!1,h=["{","}"];(v(n)&&(l=!0,h=["[","]"]),O(n))&&(f=" [Function"+(n.name?": "+n.name:"")+"]");return k(n)&&(f=" "+RegExp.prototype.toString.call(n)),x(n)&&(f=" "+Date.prototype.toUTCString.call(n)),E(n)&&(f=" "+d(n)),0!==a.length||l&&0!=n.length?r<0?k(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=l?function(t,n,r,i,e){for(var o=[],a=0,u=n.length;a<u;++a)A(n,String(a))?o.push(y(t,n,r,i,String(a),!0)):o.push("");return e.forEach(function(e){e.match(/^\d+$/)||o.push(y(t,n,r,i,e,!0))}),o}(t,n,r,u,a):a.map(function(e){return y(t,n,r,u,e,l)}),t.seen.pop(),function(e,t,n){if(60<e.reduce(function(e,t){return 0,0<=t.indexOf("\n")&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0))return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,f,h)):h[0]+f+h[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function y(e,t,n,r,i,o){var a,u,s;if((s=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?u=s.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):s.set&&(u=e.stylize("[Setter]","special")),A(r,i)||(a="["+i+"]"),u||(e.seen.indexOf(s.value)<0?-1<(u=m(n)?p(e,s.value,null):p(e,s.value,n-1)).indexOf("\n")&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),_(a)){if(o&&i.match(/^\d+$/))return u;a=(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),e.stylize(a,"string"))}return a+": "+u}function v(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function m(e){return null===e}function b(e){return"number"==typeof e}function w(e){return"string"==typeof e}function _(e){return void 0===e}function k(e){return f(e)&&"[object RegExp]"===t(e)}function f(e){return"object"==typeof e&&null!==e}function x(e){return f(e)&&"[object Date]"===t(e)}function E(e){return f(e)&&("[object Error]"===t(e)||e instanceof Error)}function O(e){return"function"==typeof e}function t(e){return Object.prototype.toString.call(e)}function n(e){return e<10?"0"+e.toString(10):e.toString(10)}I.debuglog=function(t){if(_(e)&&(e=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!o[t])if(new RegExp("\\b"+t+"\\b","i").test(e)){var n=r.pid;o[t]=function(){var e=I.format.apply(I,arguments);console.error("%s %d: %s",t,n,e)}}else o[t]=function(){};return o[t]},(I.inspect=s).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},I.isArray=v,I.isBoolean=g,I.isNull=m,I.isNullOrUndefined=function(e){return null==e},I.isNumber=b,I.isString=w,I.isSymbol=function(e){return"symbol"==typeof e},I.isUndefined=_,I.isRegExp=k,I.isObject=f,I.isDate=x,I.isError=E,I.isFunction=O,I.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},I.isBuffer=h("./support/isBuffer");var l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}I.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[n(e.getHours()),n(e.getMinutes()),n(e.getSeconds())].join(":"),[e.getDate(),l[e.getMonth()],t].join(" ")),I.format.apply(I,arguments))},I.inherits=h("inherits"),I._extend=function(e,t){if(!t||!f(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,h("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":20,_process:18,inherits:17}]},{},[3])(3)});